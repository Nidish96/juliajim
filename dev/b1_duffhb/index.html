<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>1: Duffing Oscillator · juliajim</title><meta name="title" content="1: Duffing Oscillator · juliajim"/><meta property="og:title" content="1: Duffing Oscillator · juliajim"/><meta property="twitter:title" content="1: Duffing Oscillator · juliajim"/><meta name="description" content="Documentation for juliajim."/><meta property="og:description" content="Documentation for juliajim."/><meta property="twitter:description" content="Documentation for juliajim."/><meta property="og:url" content="https://github.com/Nidish96/juliajim/b1_duffhb/"/><meta property="twitter:url" content="https://github.com/Nidish96/juliajim/b1_duffhb/"/><link rel="canonical" href="https://github.com/Nidish96/juliajim/b1_duffhb/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/custom.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">juliajim</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../a_hworld/">A: Harmonic Utilities</a></li><li><input class="collapse-toggle" id="menuitem-2-2" type="checkbox" checked/><label class="tocitem" for="menuitem-2-2"><span class="docs-label">B: Numerical Continuation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li class="is-active"><a class="tocitem" href>1: Duffing Oscillator</a><ul class="internal"><li><a class="tocitem" href="#Preamble:-Load-packages"><span>Preamble: Load packages</span></a></li><li><a class="tocitem" href="#exb1_res"><span>Define Residue Function</span></a></li><li><a class="tocitem" href="#exb1_setup"><span>Setup</span></a></li><li><a class="tocitem" href="#exb1_cont"><span>Continuation</span></a></li><li><a class="tocitem" href="#exb1_plot"><span>Plotting</span></a></li><li><a class="tocitem" href="#Outro"><span>Outro</span></a></li></ul></li><li><a class="tocitem" href="../b2_jenkhb/">2: Frictional Oscillator</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-3" type="checkbox"/><label class="tocitem" for="menuitem-2-3"><span class="docs-label">C: Examples with the MDOFUTILS Suite</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../c1_mdofgen_instnl/">1: Forced Response of a 2DoF Oscillator with Instantaneous Nonlinearity</a></li><li><a class="tocitem" href="../c2_mdofgen_hystnl/">2: Forced Response of a 2DoF Oscillator with Hysteretic Nonlinearity</a></li><li><a class="tocitem" href="../c3_mdofgen_ahb/">3: Response Constrained Forced Response of a 2DoF Hysteretic Oscillator</a></li><li><a class="tocitem" href="../c4_mdofgen_epmc/">4: Nonlinear Normal Modes of a 2DoF Hysteretic Oscillator using EPMC</a></li><li><a class="tocitem" href="../c5_mdofgen_newmark/">5: Transient Response of a 2DoF Hysteretic Oscillator using Newmark Scheme</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-4" type="checkbox"/><label class="tocitem" for="menuitem-2-4"><span class="docs-label">D: Bifurcation Analysis Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../d1_deflation/">1: Deflation to Locate Multiple roots</a></li><li><a class="tocitem" href="../d2_forcedvdp/">2: Bifurcation Analysis of the Forced Response of a Van der Pol Oscillator</a></li><li><a class="tocitem" href="../d3_normalform/">3: Branch Switching Using Normal Forms</a></li></ul></li><li><a class="tocitem" href="../f_febeam/">F: Finite Element Beam with Nonlinear Support</a></li><li><a class="tocitem" href="../reference/">Reference</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li><a class="is-disabled">B: Numerical Continuation</a></li><li class="is-active"><a href>1: Duffing Oscillator</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>1: Duffing Oscillator</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/Nidish96/juliajim/blob/master/examples/b1_duffhb.jl#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="ex_b1"><a class="docs-heading-anchor" href="#ex_b1">Example B1: Numerical Continuation on a Duffing Oscillator</a><a id="ex_b1-1"></a><a class="docs-heading-anchor-permalink" href="#ex_b1" title="Permalink"></a></h1><p>This example exposes the core functionality of <a href="../reference/#juliajim.CONTINUATION"><code>juliajim.CONTINUATION</code></a> through a very minimal example. The governing equations for the oscillator are taken as</p><p class="math-container">\[\ddot{x} + 2\zeta_0\omega_0 \dot{x} + \omega_0^2 x + \alpha x^3 = F\cos\Omega t.\]</p><p>The steps that will be followed in this file are as follows:</p><ol><li><a href="#exb1_res">First</a> we define a &quot;harmonic residue&quot; function for the Duffing oscillator in a way that returns the residue, its Jacobian with respect to the vector of harmonics (see <a href="../a_hworld/#ex_a"><code>Example a</code></a>), and also with respect to the excitation frequency.</li><li><a href="#exb1_setup">Next</a> we define the parameters for the problem and setup the necessary variables for the Harmonic Balance (and AFT).</li><li><a href="#exb1_cont">Then</a> we conduct the actual continuation after setting up parameters for this.</li><li><a href="#exb1_plot">Finally</a> the results are plotted in terms of the different harmonics present.</li></ol><h2 id="Preamble:-Load-packages"><a class="docs-heading-anchor" href="#Preamble:-Load-packages">Preamble: Load packages</a><a id="Preamble:-Load-packages-1"></a><a class="docs-heading-anchor-permalink" href="#Preamble:-Load-packages" title="Permalink"></a></h2><pre><code class="language-julia hljs">using GLMakie
using LaTeXStrings
using LinearAlgebra
using NonlinearSolve
using ForwardDiff
using DSP

using juliajim.HARMONIC
using juliajim.CONTINUATION</code></pre><h2 id="exb1_res"><a class="docs-heading-anchor" href="#exb1_res">Define Residue Function</a><a id="exb1_res-1"></a><a class="docs-heading-anchor-permalink" href="#exb1_res" title="Permalink"></a></h2><p>We setup the Harmonic Balance residue function such that it takes as input the list of harmonics and the excitation frequency as a single vector. This is convenient for bordered continuation strategies.</p><p>The computation of the residue itself is as follows:</p><ol><li>Estimate the linear harmonic stiffness</li><li>Transform the given harmonic coefficients into the time domain (for one cycle) using <a href="../reference/#juliajim.HARMONIC.AFT-NTuple{4, Any}"><code>AFT</code></a>, and use that to compute the nonlinearity in one oscillation cycle.</li><li>Transform the computed force into the Frequency domain by computing its harmonics using <a href="../reference/#juliajim.HARMONIC.AFT-NTuple{4, Any}"><code>AFT</code></a>.</li><li>Assemble the overall harmonic balance equation.</li></ol><p>Jacobian computations also follow similar steps. The function is implemented &quot;in-place&quot; in order to be efficient - the Jacobian(s) are computed only when requested.</p><pre><code class="language-julia hljs">function RESFUN!(Uw, Fl, pars, h, Nt; R=nothing, dRdU=nothing, dRdw=nothing)
    (; z0, w0, al, F) = pars;

    Om = Uw[end];
    Nhc = sum((h.==0)+2(h.!=0));

    # Linear Portion
    E, dEdw = HARMONICSTIFFNESS(1.0, 2z0*w0, w0^2, Om, h);

    # AFT For nonlinear force
    ut  = AFT(Uw[1:end-1], h, Nt, :f2t);

    # Construct Residue
    if !(R === nothing)
        ft  = al*ut.^3;
        Fnl = AFT(ft, h, Nt, :t2f);

        R[:] = E*Uw[1:end-1] + Fnl - Fl*F;
    end
    if !(dRdU === nothing)
        cst = AFT(Float64.(I(Nhc)), h, Nt, :f2t);
        dfdat = (3al*ut.^2) .* cst;
        Jnl    = AFT(dfdat, h, Nt, :t2f);

        dRdU[:, :] = E + Jnl;
    end
    if !(dRdw === nothing)
        dRdw[:] = dEdw*Uw[1:end-1];
    end
    return nothing;
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">RESFUN! (generic function with 1 method)</code></pre><h2 id="exb1_setup"><a class="docs-heading-anchor" href="#exb1_setup">Setup</a><a id="exb1_setup-1"></a><a class="docs-heading-anchor-permalink" href="#exb1_setup" title="Permalink"></a></h2><p>We now setup the parameters of the system and forcing vector for Harmonic balance.</p><pre><code class="language-julia hljs">  ξ = 1e0;  # Scaling fudge factor - change to test the robustness of the continuation
pars = (z0 = 0.5e-2, w0 = 2., al = 0.1*ξ^2, F = 0.1/ξ);

h = (0:5);  # Choose list of harmonics
# h = 1:2:5;  # Also possible
Om = 0.1;

Nhc = sum((h.==0)+2(h.!=0));
Nt = 2^9;

Fl = zeros(Nhc);
_,_,zinds,rinds,iinds = HINDS(1, h)
Fl[rinds[1]] = 1.0;</code></pre><p>Now <code>Fl</code> is the harmonic forcing vector. Next, we define a <code>NonlinearFunction</code> object (from [<code>NonlinearSolve.jl</code>]) that will be used by <code>juliajim</code> for the continuation. Note that for this, the unknowns are the harmonics and the parameter (has to be scalar) is the excitation frequency, with which the continuation procedure will be carried out.</p><p>We also use the same <code>RESFUN!</code> function defined above to specify the <code>jac</code> (jacobian w.r.t. the unknowns) and paramjac (jacobian w.r.t. the frequency). If these are left empty, <code>ForwardDiff</code> will be used to estimate them.</p><pre><code class="language-julia hljs">fun = NonlinearFunction((r,u,p)-&gt;RESFUN!([u;p],Fl,pars,h,Nt;R=r),
                        jac=(J,u,p)-&gt;RESFUN!([u;p],Fl,pars,h,Nt;dRdU=J),
                        paramjac=(Jp,u,p)-&gt;RESFUN!([u;p],Fl,pars,h,Nt;dRdw=Jp));</code></pre><p>Now we are ready!</p><h3 id="Check-by-solving-for-a-Single-point"><a class="docs-heading-anchor" href="#Check-by-solving-for-a-Single-point">Check by solving for a Single point</a><a id="Check-by-solving-for-a-Single-point-1"></a><a class="docs-heading-anchor-permalink" href="#Check-by-solving-for-a-Single-point" title="Permalink"></a></h3><p>We set the initial guess as the solution of the linearized oscillator and solve the problem using <code>NonlinearSolve.jl</code>. The following should work properly and converge within 3-4 iterations.</p><pre><code class="language-julia hljs">E = zeros(Nhc, Nhc);
HARMONICSTIFFNESS!(E, nothing, 1.0, 2pars.z0*pars.w0, pars.w0^2, Om, h);
U0 = E\ (Fl*pars.F);

prob = NonlinearProblem(fun, U0, Om);
sol = solve(prob, show_trace=Val(true));</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">
Algorithm: NewtonRaphson(
    descent = NewtonDescent(),
    autodiff = AutoForwardDiff(),
    vjp_autodiff = AutoFiniteDiff(
        fdtype = Val{:forward}(),
        fdjtype = Val{:forward}(),
        fdhtype = Val{:hcentral}(),
        dir = true
    ),
    jvp_autodiff = AutoForwardDiff(),
    concrete_jac = Val{false}()
)

----    	-------------       	-----------
Iter    	f(u) inf-norm       	Step 2-norm
----    	-------------       	-----------
0       	1.18070760e-06      	0.00000000e+00
1       	6.38378239e-16      	3.12554640e-07
Final   	6.38378239e-16
----------------------</code></pre><p>Inspecting the solution would show that the solution has only odd-harmonic content, as expected from a simple system with a cubic spring:</p><pre><code class="language-julia hljs">sol.u</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">11-element Vector{Float64}:
  0.0
  0.02506235443962234
  1.2562435359264377e-5
  0.0
  0.0
 -1.0065052318957817e-7
 -3.058003992699406e-10
  0.0
  0.0
  1.2643866782901962e-12
  8.480785528323754e-15</code></pre><h2 id="exb1_cont"><a class="docs-heading-anchor" href="#exb1_cont">Continuation</a><a id="exb1_cont-1"></a><a class="docs-heading-anchor-permalink" href="#exb1_cont" title="Permalink"></a></h2><p>Now we are ready to conduct the actual continuation. First things first, we setup the starting and ending frequencies (<code>Om0</code>, <code>Om1</code>) and the starting step length <code>dOm</code>. <strong>In <code>juliajim</code> the units of the step length are always in the same units as the continuation parameter, the excitation frequency in this case.</strong></p><pre><code class="language-julia hljs">Om0 = 2pars.w0;
Om1 = 0.02pars.w0;
dOm = 0.1pars.w0;
cpars = (parm=:arclength, nmax=2000);</code></pre><p>We also set two parameters relevant for continuation (see the documentation of <a href="../reference/#juliajim.CONTINUATION.CONTINUATE-Tuple{Vector{Float64}, Any, Vector{Float64}, Float64}"><code>CONTINUATE</code></a> for an exhaustive list of parameters with descriptions). Here we are specifying that we would use the arclength parameterization and will do the computation for a maximum of 2000 points. We provide the initial guess the same as before (of the linearized problem) and can reuse the same <code>NonlinearFunction</code> object from before.</p><pre><code class="language-julia hljs">HARMONICSTIFFNESS!(E, nothing, 1.0, 2pars.z0*pars.w0, pars.w0^2, Om0, h);
U0 = E\ (Fl*pars.F);

sols, its, dss, xis, Dsc = CONTINUATE(U0, fun, [Om0, Om1], dOm; cpars...);</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">
Algorithm: NewtonRaphson(
    descent = NewtonDescent(),
    autodiff = AutoForwardDiff(),
    vjp_autodiff = AutoFiniteDiff(
        fdtype = Val{:forward}(),
        fdjtype = Val{:forward}(),
        fdhtype = Val{:hcentral}(),
        dir = true
    ),
    jvp_autodiff = AutoForwardDiff(),
    concrete_jac = Val{false}()
)

----    	-------------       	-----------
Iter    	f(u) inf-norm       	Step 2-norm
----    	-------------       	-----------
0       	4.33989200e-08      	0.00000000e+00
1       	1.38777878e-17      	3.61805734e-09
Final   	1.38777878e-17
----------------------
2. 3.80 with step -0.2000 (0.2000) converged in 1 iterations.
3. 3.60 with step -0.2000 (0.2000) converged in 1 iterations.
4. 3.40 with step -0.2000 (0.2000) converged in 1 iterations.
5. 3.20 with step -0.2000 (0.2000) converged in 1 iterations.
6. 3.00 with step -0.2000 (0.2000) converged in 1 iterations.
7. 2.80 with step -0.1999 (0.2000) converged in 1 iterations.
8. 2.60 with step -0.1999 (0.2000) converged in 2 iterations.
9. 2.46 with step -0.1411 (0.1414) converged in 2 iterations.
10. 2.36 with step -0.0993 (0.1000) converged in 2 iterations.
11. 2.29 with step -0.0695 (0.0707) converged in 2 iterations.
12. 2.24 with step -0.0480 (0.0500) converged in 2 iterations.
13. 2.21 with step -0.0369 (0.0400) converged in 2 iterations.
14. 2.18 with step -0.0347 (0.0400) converged in 2 iterations.
15. 2.15 with step -0.0311 (0.0400) converged in 2 iterations.
16. 2.12 with step -0.0261 (0.0400) converged in 2 iterations.
17. 2.11 with step -0.0206 (0.0400) converged in 2 iterations.
18. 2.09 with step -0.0159 (0.0400) converged in 2 iterations.
19. 2.08 with step -0.0122 (0.0400) converged in 2 iterations.
20. 2.07 with step -0.0094 (0.0400) converged in 2 iterations.
21. 2.07 with step -0.0074 (0.0400) converged in 2 iterations.
22. 2.06 with step -0.0059 (0.0400) converged in 2 iterations.
23. 2.06 with step -0.0047 (0.0400) converged in 2 iterations.
24. 2.05 with step -0.0038 (0.0400) converged in 1 iterations.
25. 2.05 with step -0.0031 (0.0400) converged in 1 iterations.
26. 2.05 with step -0.0025 (0.0400) converged in 1 iterations.
27. 2.05 with step -0.0021 (0.0400) converged in 1 iterations.
28. 2.04 with step -0.0017 (0.0400) converged in 1 iterations.
29. 2.04 with step -0.0013 (0.0400) converged in 1 iterations.
30. 2.04 with step -0.0010 (0.0400) converged in 1 iterations.
31. 2.04 with step -0.0008 (0.0400) converged in 1 iterations.
32. 2.04 with step -0.0006 (0.0400) converged in 1 iterations.
33. 2.04 with step -0.0004 (0.0400) converged in 1 iterations.
34. 2.04 with step -0.0002 (0.0400) converged in 1 iterations.
35. 2.04 with step -0.0000 (0.0400) converged in 1 iterations.
36. 2.04 with step 0.0001 (0.0400) converged in 1 iterations.
37. 2.04 with step 0.0002 (0.0400) converged in 1 iterations.
38. 2.04 with step 0.0004 (0.0400) converged in 1 iterations.
39. 2.04 with step 0.0005 (0.0400) converged in 1 iterations.
40. 2.04 with step 0.0006 (0.0400) converged in 1 iterations.
41. 2.04 with step 0.0006 (0.0400) converged in 1 iterations.
42. 2.04 with step 0.0007 (0.0400) converged in 1 iterations.
43. 2.04 with step 0.0008 (0.0400) converged in 1 iterations.
44. 2.05 with step 0.0009 (0.0400) converged in 1 iterations.
45. 2.05 with step 0.0009 (0.0400) converged in 1 iterations.
46. 2.05 with step 0.0010 (0.0400) converged in 1 iterations.
47. 2.05 with step 0.0010 (0.0400) converged in 1 iterations.
48. 2.05 with step 0.0011 (0.0400) converged in 1 iterations.
49. 2.05 with step 0.0011 (0.0400) converged in 1 iterations.
50. 2.05 with step 0.0012 (0.0400) converged in 1 iterations.
51. 2.05 with step 0.0012 (0.0400) converged in 1 iterations.
52. 2.05 with step 0.0013 (0.0400) converged in 1 iterations.
53. 2.06 with step 0.0013 (0.0400) converged in 1 iterations.
54. 2.06 with step 0.0013 (0.0400) converged in 1 iterations.
55. 2.06 with step 0.0013 (0.0400) converged in 1 iterations.
56. 2.06 with step 0.0014 (0.0400) converged in 1 iterations.
57. 2.06 with step 0.0014 (0.0400) converged in 1 iterations.
58. 2.06 with step 0.0014 (0.0400) converged in 1 iterations.
59. 2.06 with step 0.0014 (0.0400) converged in 1 iterations.
60. 2.07 with step 0.0014 (0.0400) converged in 1 iterations.
61. 2.07 with step 0.0014 (0.0400) converged in 1 iterations.
62. 2.07 with step 0.0014 (0.0400) converged in 1 iterations.
63. 2.07 with step 0.0014 (0.0400) converged in 1 iterations.
64. 2.07 with step 0.0014 (0.0400) converged in 1 iterations.
65. 2.07 with step 0.0014 (0.0400) converged in 1 iterations.
66. 2.07 with step 0.0014 (0.0400) converged in 1 iterations.
67. 2.08 with step 0.0014 (0.0400) converged in 1 iterations.
68. 2.08 with step 0.0014 (0.0400) converged in 1 iterations.
69. 2.08 with step 0.0014 (0.0400) converged in 1 iterations.
70. 2.08 with step 0.0013 (0.0400) converged in 1 iterations.
71. 2.08 with step 0.0013 (0.0400) converged in 1 iterations.
72. 2.08 with step 0.0013 (0.0400) converged in 1 iterations.
73. 2.08 with step 0.0013 (0.0400) converged in 1 iterations.
74. 2.08 with step 0.0013 (0.0400) converged in 1 iterations.
75. 2.09 with step 0.0012 (0.0400) converged in 1 iterations.
76. 2.09 with step 0.0012 (0.0400) converged in 1 iterations.
77. 2.09 with step 0.0012 (0.0400) converged in 1 iterations.
78. 2.09 with step 0.0011 (0.0400) converged in 1 iterations.
79. 2.09 with step 0.0011 (0.0400) converged in 1 iterations.
80. 2.09 with step 0.0011 (0.0400) converged in 1 iterations.
81. 2.09 with step 0.0010 (0.0400) converged in 1 iterations.
82. 2.09 with step 0.0010 (0.0400) converged in 1 iterations.
83. 2.09 with step 0.0010 (0.0400) converged in 1 iterations.
84. 2.10 with step 0.0009 (0.0400) converged in 1 iterations.
85. 2.10 with step 0.0009 (0.0400) converged in 1 iterations.
86. 2.10 with step 0.0008 (0.0400) converged in 1 iterations.
87. 2.10 with step 0.0008 (0.0400) converged in 1 iterations.
88. 2.10 with step 0.0008 (0.0400) converged in 1 iterations.
89. 2.10 with step 0.0007 (0.0400) converged in 1 iterations.
90. 2.10 with step 0.0007 (0.0400) converged in 1 iterations.
91. 2.10 with step 0.0006 (0.0400) converged in 1 iterations.
92. 2.10 with step 0.0006 (0.0400) converged in 1 iterations.
93. 2.10 with step 0.0005 (0.0400) converged in 1 iterations.
94. 2.10 with step 0.0005 (0.0400) converged in 1 iterations.
95. 2.10 with step 0.0004 (0.0400) converged in 1 iterations.
96. 2.10 with step 0.0004 (0.0400) converged in 1 iterations.
97. 2.10 with step 0.0003 (0.0400) converged in 1 iterations.
98. 2.10 with step 0.0003 (0.0400) converged in 1 iterations.
99. 2.10 with step 0.0002 (0.0400) converged in 1 iterations.
100. 2.10 with step 0.0002 (0.0400) converged in 1 iterations.
101. 2.10 with step 0.0001 (0.0400) converged in 1 iterations.
102. 2.10 with step 0.0001 (0.0400) converged in 1 iterations.
103. 2.10 with step 0.0000 (0.0400) converged in 1 iterations.
104. 2.10 with step -0.0000 (0.0400) converged in 1 iterations.
105. 2.10 with step -0.0001 (0.0400) converged in 1 iterations.
106. 2.10 with step -0.0001 (0.0400) converged in 1 iterations.
107. 2.10 with step -0.0002 (0.0400) converged in 1 iterations.
108. 2.10 with step -0.0002 (0.0400) converged in 1 iterations.
109. 2.10 with step -0.0003 (0.0400) converged in 1 iterations.
110. 2.10 with step -0.0003 (0.0400) converged in 1 iterations.
111. 2.10 with step -0.0004 (0.0400) converged in 1 iterations.
112. 2.10 with step -0.0004 (0.0400) converged in 1 iterations.
113. 2.10 with step -0.0005 (0.0400) converged in 1 iterations.
114. 2.10 with step -0.0005 (0.0400) converged in 1 iterations.
115. 2.10 with step -0.0006 (0.0400) converged in 1 iterations.
116. 2.10 with step -0.0006 (0.0400) converged in 1 iterations.
117. 2.10 with step -0.0007 (0.0400) converged in 1 iterations.
118. 2.10 with step -0.0008 (0.0400) converged in 1 iterations.
119. 2.10 with step -0.0008 (0.0400) converged in 1 iterations.
120. 2.10 with step -0.0009 (0.0400) converged in 1 iterations.
121. 2.10 with step -0.0009 (0.0400) converged in 1 iterations.
122. 2.09 with step -0.0010 (0.0400) converged in 1 iterations.
123. 2.09 with step -0.0010 (0.0400) converged in 1 iterations.
124. 2.09 with step -0.0011 (0.0400) converged in 1 iterations.
125. 2.09 with step -0.0011 (0.0400) converged in 1 iterations.
126. 2.09 with step -0.0011 (0.0400) converged in 1 iterations.
127. 2.09 with step -0.0012 (0.0400) converged in 1 iterations.
128. 2.09 with step -0.0012 (0.0400) converged in 1 iterations.
129. 2.09 with step -0.0013 (0.0400) converged in 1 iterations.
130. 2.08 with step -0.0013 (0.0400) converged in 1 iterations.
131. 2.08 with step -0.0014 (0.0400) converged in 1 iterations.
132. 2.08 with step -0.0014 (0.0400) converged in 1 iterations.
133. 2.08 with step -0.0015 (0.0400) converged in 1 iterations.
134. 2.08 with step -0.0015 (0.0400) converged in 1 iterations.
135. 2.08 with step -0.0015 (0.0400) converged in 1 iterations.
136. 2.08 with step -0.0016 (0.0400) converged in 1 iterations.
137. 2.07 with step -0.0016 (0.0400) converged in 1 iterations.
138. 2.07 with step -0.0017 (0.0400) converged in 1 iterations.
139. 2.07 with step -0.0017 (0.0400) converged in 1 iterations.
140. 2.07 with step -0.0017 (0.0400) converged in 1 iterations.
141. 2.07 with step -0.0018 (0.0400) converged in 1 iterations.
142. 2.07 with step -0.0018 (0.0400) converged in 1 iterations.
143. 2.06 with step -0.0018 (0.0400) converged in 1 iterations.
144. 2.06 with step -0.0019 (0.0400) converged in 1 iterations.
145. 2.06 with step -0.0019 (0.0400) converged in 1 iterations.
146. 2.06 with step -0.0019 (0.0400) converged in 1 iterations.
147. 2.06 with step -0.0019 (0.0400) converged in 1 iterations.
148. 2.05 with step -0.0020 (0.0400) converged in 1 iterations.
149. 2.05 with step -0.0020 (0.0400) converged in 1 iterations.
150. 2.05 with step -0.0020 (0.0400) converged in 1 iterations.
151. 2.05 with step -0.0020 (0.0400) converged in 1 iterations.
152. 2.05 with step -0.0020 (0.0400) converged in 1 iterations.
153. 2.04 with step -0.0021 (0.0400) converged in 1 iterations.
154. 2.04 with step -0.0021 (0.0400) converged in 1 iterations.
155. 2.04 with step -0.0021 (0.0400) converged in 1 iterations.
156. 2.04 with step -0.0021 (0.0400) converged in 1 iterations.
157. 2.03 with step -0.0021 (0.0400) converged in 1 iterations.
158. 2.03 with step -0.0021 (0.0400) converged in 1 iterations.
159. 2.03 with step -0.0021 (0.0400) converged in 1 iterations.
160. 2.03 with step -0.0022 (0.0400) converged in 1 iterations.
161. 2.03 with step -0.0022 (0.0400) converged in 1 iterations.
162. 2.02 with step -0.0022 (0.0400) converged in 1 iterations.
163. 2.02 with step -0.0022 (0.0400) converged in 1 iterations.
164. 2.02 with step -0.0022 (0.0400) converged in 1 iterations.
165. 2.02 with step -0.0022 (0.0400) converged in 1 iterations.
166. 2.02 with step -0.0022 (0.0400) converged in 1 iterations.
167. 2.01 with step -0.0022 (0.0400) converged in 1 iterations.
168. 2.01 with step -0.0022 (0.0400) converged in 1 iterations.
169. 2.01 with step -0.0022 (0.0400) converged in 1 iterations.
170. 2.01 with step -0.0022 (0.0400) converged in 1 iterations.
171. 2.00 with step -0.0023 (0.0400) converged in 1 iterations.
172. 2.00 with step -0.0023 (0.0400) converged in 1 iterations.
173. 2.00 with step -0.0023 (0.0400) converged in 1 iterations.
174. 2.00 with step -0.0023 (0.0400) converged in 1 iterations.
175. 1.99 with step -0.0024 (0.0400) converged in 1 iterations.
176. 1.99 with step -0.0024 (0.0400) converged in 1 iterations.
177. 1.99 with step -0.0024 (0.0400) converged in 1 iterations.
178. 1.99 with step -0.0025 (0.0400) converged in 1 iterations.
179. 1.98 with step -0.0025 (0.0400) converged in 1 iterations.
180. 1.98 with step -0.0026 (0.0400) converged in 1 iterations.
181. 1.98 with step -0.0027 (0.0400) converged in 1 iterations.
182. 1.98 with step -0.0028 (0.0400) converged in 1 iterations.
183. 1.97 with step -0.0030 (0.0400) converged in 1 iterations.
184. 1.97 with step -0.0032 (0.0400) converged in 1 iterations.
185. 1.97 with step -0.0034 (0.0400) converged in 1 iterations.
186. 1.96 with step -0.0036 (0.0400) converged in 1 iterations.
187. 1.96 with step -0.0040 (0.0400) converged in 1 iterations.
188. 1.95 with step -0.0044 (0.0400) converged in 1 iterations.
189. 1.95 with step -0.0049 (0.0400) converged in 1 iterations.
190. 1.94 with step -0.0056 (0.0400) converged in 2 iterations.
191. 1.94 with step -0.0066 (0.0400) converged in 2 iterations.
192. 1.93 with step -0.0078 (0.0400) converged in 2 iterations.
193. 1.92 with step -0.0094 (0.0400) converged in 2 iterations.
194. 1.90 with step -0.0117 (0.0400) converged in 2 iterations.
195. 1.89 with step -0.0148 (0.0400) converged in 2 iterations.
196. 1.87 with step -0.0189 (0.0400) converged in 2 iterations.
197. 1.84 with step -0.0239 (0.0400) converged in 2 iterations.
198. 1.81 with step -0.0291 (0.0400) converged in 2 iterations.
199. 1.77 with step -0.0333 (0.0400) converged in 2 iterations.
200. 1.74 with step -0.0361 (0.0400) converged in 2 iterations.
201. 1.70 with step -0.0377 (0.0400) converged in 2 iterations.
202. 1.66 with step -0.0386 (0.0400) converged in 2 iterations.
203. 1.62 with step -0.0391 (0.0400) converged in 1 iterations.
204. 1.58 with step -0.0394 (0.0400) converged in 1 iterations.
205. 1.54 with step -0.0396 (0.0400) converged in 1 iterations.
206. 1.50 with step -0.0397 (0.0400) converged in 1 iterations.
207. 1.46 with step -0.0398 (0.0400) converged in 1 iterations.
208. 1.42 with step -0.0399 (0.0400) converged in 1 iterations.
209. 1.38 with step -0.0399 (0.0400) converged in 1 iterations.
210. 1.34 with step -0.0399 (0.0400) converged in 1 iterations.
211. 1.30 with step -0.0399 (0.0400) converged in 1 iterations.
212. 1.26 with step -0.0400 (0.0400) converged in 1 iterations.
213. 1.22 with step -0.0400 (0.0400) converged in 1 iterations.
214. 1.18 with step -0.0400 (0.0400) converged in 1 iterations.
215. 1.14 with step -0.0400 (0.0400) converged in 1 iterations.
216. 1.10 with step -0.0400 (0.0400) converged in 1 iterations.
217. 1.06 with step -0.0400 (0.0400) converged in 1 iterations.
218. 1.02 with step -0.0400 (0.0400) converged in 1 iterations.
219. 0.98 with step -0.0400 (0.0400) converged in 1 iterations.
220. 0.94 with step -0.0400 (0.0400) converged in 1 iterations.
221. 0.90 with step -0.0400 (0.0400) converged in 1 iterations.
222. 0.86 with step -0.0400 (0.0400) converged in 1 iterations.
223. 0.82 with step -0.0400 (0.0400) converged in 1 iterations.
224. 0.78 with step -0.0400 (0.0400) converged in 1 iterations.
225. 0.74 with step -0.0400 (0.0400) converged in 1 iterations.
226. 0.70 with step -0.0400 (0.0400) converged in 1 iterations.
227. 0.66 with step -0.0400 (0.0400) converged in 1 iterations.
228. 0.62 with step -0.0400 (0.0400) converged in 1 iterations.
229. 0.58 with step -0.0400 (0.0400) converged in 1 iterations.
230. 0.54 with step -0.0400 (0.0400) converged in 1 iterations.
231. 0.50 with step -0.0400 (0.0400) converged in 1 iterations.
232. 0.46 with step -0.0400 (0.0400) converged in 1 iterations.
233. 0.42 with step -0.0400 (0.0400) converged in 1 iterations.
234. 0.38 with step -0.0400 (0.0400) converged in 1 iterations.
235. 0.34 with step -0.0400 (0.0400) converged in 1 iterations.
236. 0.30 with step -0.0400 (0.0400) converged in 1 iterations.
237. 0.26 with step -0.0400 (0.0400) converged in 1 iterations.
238. 0.22 with step -0.0400 (0.0400) converged in 1 iterations.
239. 0.18 with step -0.0400 (0.0400) converged in 1 iterations.
240. 0.14 with step -0.0400 (0.0400) converged in 1 iterations.
241. 0.10 with step -0.0400 (0.0400) converged in 1 iterations.
242. 0.06 with step -0.0400 (0.0400) converged in 1 iterations.
243. 0.02 with step -0.0400 (0.0400) converged in 1 iterations.</code></pre><p>CONTINUATE returns, firstly, a vector of <a href="../reference/#juliajim.CONTINUATION.myNLSoln"><code>myNLSoln</code></a> objects. These store the solution vector <code>up</code>, local tanget <code>dupds</code>, and any Jacobians if required.</p><p>In order to help with plotting and other postprocessing, it is sometimes helpful to express the harmonics in the complex notation. So we do that here before moving on to plotting.</p><pre><code class="language-julia hljs">uh = zeros(Complex, maximum(h)+1, length(sols));
uh[h.+1, :] = hcat([[s.up[zinds]; s.up[rinds]+1im*s.up[iinds]] for s in sols]...);
Oms = [s.up[end] for s in sols];</code></pre><h2 id="exb1_plot"><a class="docs-heading-anchor" href="#exb1_plot">Plotting</a><a id="exb1_plot-1"></a><a class="docs-heading-anchor-permalink" href="#exb1_plot" title="Permalink"></a></h2><p>Now we choose a few harmonics and plot them using <a href="https://docs.makie.org/stable/explanations/backends/glmakie.html"><code>GLMakie</code></a> (I highly recommend Makie for interativity as well as for its rich feature-set). The output should show the primary resonance (visible in all harmonics) as well as secondary superharmonic resonances (visible in the higher harmonics).</p><pre><code class="language-julia hljs">his = [1, 3, 5];

fsz = 24;
fig = Figure(fontsize=fsz, size = (1000, 600));

ax1s = [];
ax2s = [];
for i in eachindex(his[his.&lt;=maximum(h)])
    ax = Axis(fig[1, i], ylabel=L&quot;$H_%$(his[i])$ Response (m)&quot;, yscale=log10);
    scatterlines!(ax, Oms, abs.(uh[his[i].+1, :]));
    push!(ax1s, ax);

    ax = Axis(fig[2, i], xlabel=L&quot;Excitation Frequency $\Omega$&quot;,
              ylabel=L&quot;$H_%$(his[i])$ Phase (rad)&quot;);
    scatterlines!(ax, Oms, unwrap(angle.(uh[his[i].+1, :])));
    push!(ax2s, ax);
end
linkxaxes!(vcat(ax1s, ax2s)...)

    fig</code></pre><img src="f5e37d99.png" alt="Example block output"/><h2 id="Outro"><a class="docs-heading-anchor" href="#Outro">Outro</a><a id="Outro-1"></a><a class="docs-heading-anchor-permalink" href="#Outro" title="Permalink"></a></h2><p>This file shows how to use the routines in <a href="../reference/#juliajim.HARMONIC"><code>HARMONIC</code></a> to construct a residue and then use this function with <a href="../reference/#juliajim.CONTINUATION"><code>CONTINUATION</code></a> to conduct numerical continuation to compute its forced response.</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../a_hworld/">« A: Harmonic Utilities</a><a class="docs-footer-nextpage" href="../b2_jenkhb/">2: Frictional Oscillator »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Friday 9 January 2026 19:13">Friday 9 January 2026</span>. Using Julia version 1.12.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
