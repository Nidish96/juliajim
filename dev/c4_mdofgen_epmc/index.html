<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>4: Nonlinear Normal Modes of a 2DoF Hysteretic Oscillator using EPMC · juliajim</title><meta name="title" content="4: Nonlinear Normal Modes of a 2DoF Hysteretic Oscillator using EPMC · juliajim"/><meta property="og:title" content="4: Nonlinear Normal Modes of a 2DoF Hysteretic Oscillator using EPMC · juliajim"/><meta property="twitter:title" content="4: Nonlinear Normal Modes of a 2DoF Hysteretic Oscillator using EPMC · juliajim"/><meta name="description" content="Documentation for juliajim."/><meta property="og:description" content="Documentation for juliajim."/><meta property="twitter:description" content="Documentation for juliajim."/><meta property="og:url" content="https://github.com/Nidish96/juliajim/c4_mdofgen_epmc/"/><meta property="twitter:url" content="https://github.com/Nidish96/juliajim/c4_mdofgen_epmc/"/><link rel="canonical" href="https://github.com/Nidish96/juliajim/c4_mdofgen_epmc/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/custom.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">juliajim</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../a_hworld/">A: Harmonic Utilities</a></li><li><input class="collapse-toggle" id="menuitem-2-2" type="checkbox"/><label class="tocitem" for="menuitem-2-2"><span class="docs-label">B: Numerical Continuation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../b1_duffhb/">1: Duffing Oscillator</a></li><li><a class="tocitem" href="../b2_jenkhb/">2: Frictional Oscillator</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-3" type="checkbox" checked/><label class="tocitem" for="menuitem-2-3"><span class="docs-label">C: Examples with the MDOFUTILS Suite</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../c1_mdofgen_instnl/">1: Forced Response of a 2DoF Oscillator with Instantaneous Nonlinearity</a></li><li><a class="tocitem" href="../c2_mdofgen_hystnl/">2: Forced Response of a 2DoF Oscillator with Hysteretic Nonlinearity</a></li><li><a class="tocitem" href="../c3_mdofgen_ahb/">3: Response Constrained Forced Response of a 2DoF Hysteretic Oscillator</a></li><li class="is-active"><a class="tocitem" href>4: Nonlinear Normal Modes of a 2DoF Hysteretic Oscillator using EPMC</a><ul class="internal"><li><a class="tocitem" href="#Preamble:-Load-Packages"><span>Preamble: Load Packages</span></a></li><li><a class="tocitem" href="#exc4_setup"><span>System Setup</span></a></li><li><a class="tocitem" href="#exc4_linmodal"><span>Linear Modal Analysis</span></a></li><li><a class="tocitem" href="#exc4_hbsetup"><span>Setup HB</span></a></li><li><a class="tocitem" href="#exc4_epmcres"><span>Test EPMC Residue</span></a></li><li><a class="tocitem" href="#exc4_cont"><span>Continuation</span></a></li><li><a class="tocitem" href="#exc4_plot"><span>Plotting</span></a></li></ul></li><li><a class="tocitem" href="../c5_mdofgen_newmark/">5: Transient Response of a 2DoF Hysteretic Oscillator using Newmark Scheme</a></li></ul></li></ul></li><li><a class="tocitem" href="../reference/">Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li><a class="is-disabled">C: Examples with the MDOFUTILS Suite</a></li><li class="is-active"><a href>4: Nonlinear Normal Modes of a 2DoF Hysteretic Oscillator using EPMC</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>4: Nonlinear Normal Modes of a 2DoF Hysteretic Oscillator using EPMC</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/Nidish96/juliajim/blob/master/examples/c4_mdofgen_epmc.jl#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="ex_c4"><a class="docs-heading-anchor" href="#ex_c4">Example C4: Nonlinear Normal Modes of a 2DoF Hysteretic Oscillator using the Extended Periodic Motion Concept</a><a id="ex_c4-1"></a><a class="docs-heading-anchor-permalink" href="#ex_c4" title="Permalink"></a></h1><div class="admonition is-info" id="The-Extended-Periodic-Motion-Concept-8b8b2ad5f6764bc3"><header class="admonition-header">The Extended Periodic Motion Concept<a class="admonition-anchor" href="#The-Extended-Periodic-Motion-Concept-8b8b2ad5f6764bc3" title="Permalink"></a></header><div class="admonition-body"><p>Nonlinear normal modes is a very succinct methodology for describing the dynamics of nonlinear systems. It leads to descriptions of the dynamics in terms of amplitude-dependent natural frequency, daming factor, and mode-shapes for each mode. The <a href="https://doi.org/10.1016/j.compstruc.2015.03.008">Extended Periodic Motion Concept</a> is a very popular methodology for capturing these numerically. The idea here is simple - it iteratively looks for what would be a linear self excitation (in terms of a negative viscous factor) that must be supplied to a system so that it has a periodic solution as an invariant set in its unforced state.</p><p>Mathematically the system we will be solving is:</p><p class="math-container">\[\mx{M} \ddot{\vc{u}} + \mx{C} \dot{\vc{u}} + \mx{K} \vc{u} + \vc{f_{nl}} = \xi \mx{M} \dot{\vc{u}}\]</p><p>where <span>$\xi$</span> controls the strength of the self-excitation. Since the system is always solved by the trivial solution, an amplitude constraint is often imposed. In order to simplify calculations later on, the first harmonic amplitude of the degrees of freedom is constrained as:</p><p class="math-container">\[\vc{U}_{c1}^T \mx{M} \vc{U}_{c1} + \vc{U}_{s1}^T \mx{M} \vc{U}_{s1} = a^2\]</p><p>where <span>$\vc{U}_{c1} = \frac{\Omega}{\pi} \int_0^{2\pi/\Omega} \vc{u} \cos\Omega t dt$</span> and <span>$\vc{U}_{s1} = \frac{\Omega}{\pi} \int_0^{2\pi/\Omega} \vc{u} \sin\Omega t dt$</span>. (a) is the user-specified amplitude, which serves as the continuation parameter in this context. In addition to this, there is still a phase indeterminacy present in the system. So we choose an arbitrary DoF (which is expected to be non-zero in the mode under consideration), and set its cosine harmonic to be zero (other constraints are also possible). With this, we will have a square system (same number of unknowns as equations) and it can be solved to obtain the amplitude-dependent nonlinear modal characteristics of the system.</p></div></div><p>The <a href="../reference/#juliajim.MDOFUTILS.EPMCRESFUN!-Tuple{Any, MDOFGEN, Any, Any, Int64}"><code>EPMCRESFUN!</code></a> routine in <a href="../reference/#juliajim.MDOFUTILS"><code>MDOFUTILS</code></a> implements the residue function for EPMC that can be used in tandem with <a href="../reference/#juliajim.CONTINUATION"><code>CONTINUATION</code></a> to obtain nonlinear modal characteristics. This example will illustrate this on the frictional 2DoF oscillator under consideration in Examples <a href="../c2_mdofgen_hystnl/#ex_c2">C2</a> and <a href="../c3_mdofgen_ahb/#ex_c3">C3</a>. The steps followed are:</p><ol><li><a href="#exc4_setup">First</a> the system is setup (along with the nonlinearity, see descriptions in <a href="../c2_mdofgen_hystnl/#exc2_setup">Example C2</a>.</li><li><a href="#exc4_linmodal">Next</a> we conduct linear modal analysis on the linearized system. This is important to set the initial guess for the EPMC run next.</li><li><a href="#exc4_hbsetup">Now</a> we setup the Harmonic Balance parameters and then <a href="#exc4_epmcres">test out the EPMC residue routine</a> using the linearized modes estimated above.</li><li><a href="#exc4_cont">Finally</a> we conduct the contuation over the modal amplitude (a) and then <a href="#exc4_plot">visualize</a> the results.</li></ol><h2 id="Preamble:-Load-Packages"><a class="docs-heading-anchor" href="#Preamble:-Load-Packages">Preamble: Load Packages</a><a id="Preamble:-Load-Packages-1"></a><a class="docs-heading-anchor-permalink" href="#Preamble:-Load-Packages" title="Permalink"></a></h2><pre><code class="language-julia hljs">using GLMakie
using LinearAlgebra
using SparseArrays
using ForwardDiff
using NonlinearSolve
using DSP

using juliajim.HARMONIC
using juliajim.CONTINUATION
using juliajim.MDOFUTILS</code></pre><h2 id="exc4_setup"><a class="docs-heading-anchor" href="#exc4_setup">System Setup</a><a id="exc4_setup-1"></a><a class="docs-heading-anchor-permalink" href="#exc4_setup" title="Permalink"></a></h2><p>MCK matrices and nonlinearity setup: identical to <a href="../c2_mdofgen_hystnl/#exc2_setup">Example C2</a>.</p><pre><code class="language-julia hljs">M = I(2);
K = [2 -1;-1 2];
C = 0.01*M+0.001*K;

mdl = MDOFGEN(M, C, K);

# Nonlinearity
kt = 1.0;
fs = 1.0;
fnl = (t,u,up,fp)-&gt; if all(abs.(fp+kt*(u-up)).&lt;fs)
    return fp+kt*(u-up), kt*ones(size(u)), -kt*ones(size(u)), ones(size(u)); else
        return fs*sign.(fp+kt*(u-up)), zeros(size(u)), zeros(size(u)), zeros(size(u));
end
L = [0.0 1.0];

mdl = ADDNL(mdl, :Hyst, fnl, L);</code></pre><h2 id="exc4_linmodal"><a class="docs-heading-anchor" href="#exc4_linmodal">Linear Modal Analysis</a><a id="exc4_linmodal-1"></a><a class="docs-heading-anchor-permalink" href="#exc4_linmodal" title="Permalink"></a></h2><p>Remember that in the limit of small amplitude, the Jenkins element acts like a linear spring. So we add this additional stiffness to the linearized stiffness matrix and conduct the modal analysis (eigen decomposition). The mode shapes, natural frequencies, and damping are saved since these will be used next as the initial guess for EPMC.</p><pre><code class="language-julia hljs">Knl0 = L&#39;kt*L;
K0 = mdl.K+Knl0;
D, V = eigen(K0, mdl.M)
W0s = sqrt.(D);
Xis = diag(V&#39;mdl.C*V)

mi = 1;  # Mode of interest</code></pre><h2 id="exc4_hbsetup"><a class="docs-heading-anchor" href="#exc4_hbsetup">Setup HB</a><a id="exc4_hbsetup-1"></a><a class="docs-heading-anchor-permalink" href="#exc4_hbsetup" title="Permalink"></a></h2><p>Setting up parameters for Harmonic Balance: identical to <a href="../c2_mdofgen_hystnl/#exc2_setup">Example C2</a>.</p><pre><code class="language-julia hljs">h = 0:5;
N = 256;
t = (0:N-1)*2π/N;

Nhc = sum(all(h.==0, dims=2) + 2any(h.!=0, dims=2));

_, _, zinds, rinds, iinds = HINDS(mdl.Ndofs, h)
Fl = zeros(Nhc*mdl.Ndofs);
Fl[rinds[1]] = 1.0;

E, dEdw = HARMONICSTIFFNESS(mdl.M, mdl.C, mdl.K, W0s[mi], h);

U0 = zeros(mdl.Ndofs*Nhc);
U0[iinds[1:mdl.Ndofs]] = V[:, mi];</code></pre><h2 id="exc4_epmcres"><a class="docs-heading-anchor" href="#exc4_epmcres">Test EPMC Residue</a><a id="exc4_epmcres-1"></a><a class="docs-heading-anchor-permalink" href="#exc4_epmcres" title="Permalink"></a></h2><p>The ordering of unknowns that will be sent to the <a href="../reference/#juliajim.MDOFUTILS.EPMCRESFUN!-Tuple{Any, MDOFGEN, Any, Any, Int64}"><code>EPMCRESFUN!</code></a> routine is (\begin{bmatrix} \vc{u}^T&amp;\omega&amp;\xi&amp;\log_{10}(a) \end{bmatrix}^T), where the last parameter is the log of the amplitude (base 10). The log-scaling is done on the amplitude to help with numerical conditioning issues.</p><p>In the following we setup everything and test it to ensure that the residue can be used to converge to the solution.</p><pre><code class="language-julia hljs">R = zeros(mdl.Ndofs*Nhc+2);
dRdU = zeros(mdl.Ndofs*Nhc+2, mdl.Ndofs*Nhc+2);
dRda = zeros(mdl.Ndofs*Nhc+2);

EPMCRESFUN!([U0; W0s[mi]; Xis[mi]; -2], mdl, Fl, h, N; R=R, dRdUwx=dRdU, dRda=dRda)

A0 = -2.0;

U0 = zeros(mdl.Ndofs*Nhc);
U0[iinds[1:mdl.Ndofs]] = V[:, mi];

fun = NonlinearFunction((r,uwx,p)-&gt;EPMCRESFUN!([uwx;p], mdl, Fl, h, N; R=r),
    jac=(J,uwx,p)-&gt;EPMCRESFUN!([uwx;p], mdl, Fl, h, N; dRdUwx=J),
    paramjac=(Jp,uwx,p)-&gt;EPMCRESFUN!([uwx;p], mdl, Fl, h, N; dRda=Jp));

prob = NonlinearProblem(fun, [U0;W0s[mi];Xis[mi]], A0);
sol = solve(prob, show_trace=Val(true), maxiters=100);</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">
Algorithm: NewtonRaphson(
    descent = NewtonDescent(),
    autodiff = AutoForwardDiff(),
    vjp_autodiff = AutoFiniteDiff(
        fdtype = Val{:forward}(),
        fdjtype = Val{:forward}(),
        fdhtype = Val{:hcentral}(),
        dir = true
    ),
    jvp_autodiff = AutoForwardDiff(),
    concrete_jac = Val{false}()
)

----    	-------------       	-----------
Iter    	f(u) inf-norm       	Step 2-norm
----    	-------------       	-----------
0       	4.47213595e-06      	0.00000000e+00
1       	7.63931298e-08      	2.76393076e-04
2       	1.33226763e-15      	3.81965696e-08
Final   	1.33226763e-15
----------------------</code></pre><h2 id="exc4_cont"><a class="docs-heading-anchor" href="#exc4_cont">Continuation</a><a id="exc4_cont-1"></a><a class="docs-heading-anchor-permalink" href="#exc4_cont" title="Permalink"></a></h2><p>Now we are ready to conduct continuation to obtain the amplitude dependent resonance backbone for the system. The invocation of <a href="../reference/#juliajim.CONTINUATION.CONTINUATE-Tuple{Vector{Float64}, Any, Vector{Float64}, Float64}"><code>CONTINUATE</code></a> is exactly as encountered in the earlier examples.</p><pre><code class="language-julia hljs">A0 = -1.;
A1 = 3.;
da = 0.05;
cpars = (parm=:arclength, nmax=1000, Dsc=:none, itopt=4, dpbnds=[da/5, 2da]);

sols, its, dss, xis, Dsc = CONTINUATE([U0;W0s[mi];Xis[mi]], fun, [A0, A1], da; cpars...);

uh = zeros(Complex, maximum(h)+1, length(sols), 2);
for i in 1:2
    uh[h.+1, :, i] = hcat([[s.up[zinds[i:2:end]];
                            s.up[rinds[i:2:end]]+1im*s.up[iinds[i:2:end]]]
                          for s in sols]...);
end
Oms = [s.up[end-2] for s in sols];
Zts = [s.up[end-1] for s in sols]./2Oms;
As = [10^s.up[end] for s in sols];</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">
Algorithm: NewtonRaphson(
    descent = NewtonDescent(),
    autodiff = AutoForwardDiff(),
    vjp_autodiff = AutoFiniteDiff(
        fdtype = Val{:forward}(),
        fdjtype = Val{:forward}(),
        fdhtype = Val{:hcentral}(),
        dir = true
    ),
    jvp_autodiff = AutoForwardDiff(),
    concrete_jac = Val{false}()
)

----    	-------------       	-----------
Iter    	f(u) inf-norm       	Step 2-norm
----    	-------------       	-----------
0       	4.47213595e-05      	0.00000000e+00
1       	7.63931298e-08      	2.76393076e-04
2       	1.33226763e-15      	3.81965696e-08
Final   	1.33226763e-15
----------------------
2. -0.95 with step 0.0500 (0.0500) converged in 1 iterations.
3. -0.85 with step 0.1000 (0.1000) converged in 1 iterations.
4. -0.75 with step 0.1000 (0.1000) converged in 1 iterations.
5. -0.65 with step 0.1000 (0.1000) converged in 1 iterations.
6. -0.55 with step 0.1000 (0.1000) converged in 1 iterations.
7. -0.45 with step 0.1000 (0.1000) converged in 1 iterations.
8. -0.35 with step 0.1000 (0.1000) converged in 1 iterations.
9. -0.25 with step 0.1000 (0.1000) converged in 1 iterations.
10. -0.15 with step 0.1000 (0.1000) converged in 1 iterations.
11. -0.05 with step 0.1000 (0.1000) converged in 1 iterations.
12. 0.05 with step 0.1000 (0.1000) converged in 1 iterations.
13. 0.15 with step 0.1000 (0.1000) converged in 1 iterations.
14. 0.25 with step 0.1000 (0.1000) converged in 1 iterations.
15. 0.33 with step 0.1000 (0.1000) converged in 5 iterations.
16. 0.40 with step 0.0634 (0.0894) converged in 3 iterations.
17. 0.48 with step 0.0760 (0.1000) converged in 4 iterations.
18. 0.57 with step 0.0842 (0.1000) converged in 3 iterations.
19. 0.66 with step 0.0904 (0.1000) converged in 3 iterations.
20. 0.75 with step 0.0938 (0.1000) converged in 3 iterations.
21. 0.85 with step 0.0956 (0.1000) converged in 3 iterations.
22. 0.95 with step 0.0967 (0.1000) converged in 3 iterations.
23. 1.05 with step 0.0976 (0.1000) converged in 3 iterations.
24. 1.14 with step 0.0983 (0.1000) converged in 3 iterations.
25. 1.24 with step 0.0988 (0.1000) converged in 3 iterations.
26. 1.34 with step 0.0992 (0.1000) converged in 3 iterations.
27. 1.44 with step 0.0995 (0.1000) converged in 3 iterations.
28. 1.54 with step 0.0996 (0.1000) converged in 3 iterations.
29. 1.64 with step 0.0998 (0.1000) converged in 3 iterations.
30. 1.74 with step 0.0998 (0.1000) converged in 3 iterations.
31. 1.84 with step 0.0999 (0.1000) converged in 3 iterations.
32. 1.94 with step 0.0999 (0.1000) converged in 3 iterations.
33. 2.04 with step 0.1000 (0.1000) converged in 3 iterations.
34. 2.14 with step 0.1000 (0.1000) converged in 3 iterations.
35. 2.24 with step 0.1000 (0.1000) converged in 3 iterations.
36. 2.34 with step 0.1000 (0.1000) converged in 3 iterations.
37. 2.44 with step 0.1000 (0.1000) converged in 2 iterations.
38. 2.54 with step 0.1000 (0.1000) converged in 2 iterations.
39. 2.64 with step 0.1000 (0.1000) converged in 2 iterations.
40. 2.74 with step 0.1000 (0.1000) converged in 2 iterations.
41. 2.84 with step 0.1000 (0.1000) converged in 2 iterations.
42. 2.94 with step 0.1000 (0.1000) converged in 2 iterations.
43. 3.04 with step 0.1000 (0.1000) converged in 2 iterations.</code></pre><h2 id="exc4_plot"><a class="docs-heading-anchor" href="#exc4_plot">Plotting</a><a id="exc4_plot-1"></a><a class="docs-heading-anchor-permalink" href="#exc4_plot" title="Permalink"></a></h2><p>Finally we visualize the results in terms of harmonics as well as in terms of natural frequency and (equivalent) damping factor characteristic curves.</p><pre><code class="language-julia hljs">his = [1, 3, 5];

set_theme!(theme_latexfonts());
fsz = 20;
fig = Figure(fontsize=fsz, size=(1000, 600));

axs = [];
for i in eachindex(his[his.&lt;=maximum(h)])
    ax = Axis(fig[1, i],
        ylabel=L&quot;$H_%$(his[i])$ Response (m)&quot;, xscale=log10, yscale=log10);
    scatterlines!(ax, As, abs.(uh[his[i].+1, :, 1]), label=&quot;x1&quot;);
    scatterlines!(ax, As, abs.(uh[his[i].+1, :, 2]), label=&quot;x2&quot;);
    push!(axs, ax)

    ax = Axis(fig[2, i], xlabel=L&quot;Modal Amplitude $a$&quot;,
        ylabel=L&quot;$H_%$(his[i])$ Phase (rad)&quot;, xscale=log10);
    scatterlines!(ax, As, unwrap(angle.(uh[his[i].+1, :, 1])), label=&quot;x1&quot;);
    scatterlines!(ax, As, unwrap(angle.(uh[his[i].+1, :, 2])), label=&quot;x2&quot;);
    push!(axs, ax)
    if i==1
        axislegend(ax)
    end
end
ax = Axis(fig[1, length(his)+1],
    ylabel=L&quot;Natural Frequency $\omega_n$ (rad/s)&quot;, xscale=log10);
scatterlines!(ax, As, Oms);
push!(axs, ax)

ax = Axis(fig[2, length(his)+1], xlabel=L&quot;Modal Amplitude $a$&quot;,
    ylabel=&quot;Damping Factor (%)&quot;, xscale=log10);
scatterlines!(ax, As, 100Zts);
push!(axs, ax)

linkxaxes!(axs...)

    fig</code></pre><img src="e90004e7.png" alt="Example block output"/><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../c3_mdofgen_ahb/">« 3: Response Constrained Forced Response of a 2DoF Hysteretic Oscillator</a><a class="docs-footer-nextpage" href="../c5_mdofgen_newmark/">5: Transient Response of a 2DoF Hysteretic Oscillator using Newmark Scheme »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Sunday 28 September 2025 11:13">Sunday 28 September 2025</span>. Using Julia version 1.11.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
