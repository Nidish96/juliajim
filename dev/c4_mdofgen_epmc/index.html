<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>4: Nonlinear Normal Modes of a 2DoF Hysteretic Oscillator using EPMC · juliajim</title><meta name="title" content="4: Nonlinear Normal Modes of a 2DoF Hysteretic Oscillator using EPMC · juliajim"/><meta property="og:title" content="4: Nonlinear Normal Modes of a 2DoF Hysteretic Oscillator using EPMC · juliajim"/><meta property="twitter:title" content="4: Nonlinear Normal Modes of a 2DoF Hysteretic Oscillator using EPMC · juliajim"/><meta name="description" content="Documentation for juliajim."/><meta property="og:description" content="Documentation for juliajim."/><meta property="twitter:description" content="Documentation for juliajim."/><meta property="og:url" content="https://github.com/Nidish96/juliajim/c4_mdofgen_epmc/"/><meta property="twitter:url" content="https://github.com/Nidish96/juliajim/c4_mdofgen_epmc/"/><link rel="canonical" href="https://github.com/Nidish96/juliajim/c4_mdofgen_epmc/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/custom.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">juliajim</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../a_hworld/">A: Harmonic Utilities</a></li><li><input class="collapse-toggle" id="menuitem-2-2" type="checkbox"/><label class="tocitem" for="menuitem-2-2"><span class="docs-label">B: Numerical Continuation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../b1_duffhb/">1: Duffing Oscillator</a></li><li><a class="tocitem" href="../b2_jenkhb/">2: Frictional Oscillator</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-3" type="checkbox" checked/><label class="tocitem" for="menuitem-2-3"><span class="docs-label">C: Examples with the MDOFUTILS Suite</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../c1_mdofgen_instnl/">1: Forced Response of a 2DoF Oscillator with Instantaneous Nonlinearity</a></li><li><a class="tocitem" href="../c2_mdofgen_hystnl/">2: Forced Response of a 2DoF Oscillator with Hysteretic Nonlinearity</a></li><li><a class="tocitem" href="../c3_mdofgen_ahb/">3: Response Constrained Forced Response of a 2DoF Hysteretic Oscillator</a></li><li class="is-active"><a class="tocitem" href>4: Nonlinear Normal Modes of a 2DoF Hysteretic Oscillator using EPMC</a><ul class="internal"><li><a class="tocitem" href="#Preamble:-Load-Packages"><span>Preamble: Load Packages</span></a></li><li><a class="tocitem" href="#exc4_setup"><span>System Setup</span></a></li><li><a class="tocitem" href="#exc4_linmodal"><span>Linear Modal Analysis</span></a></li><li><a class="tocitem" href="#exc4_hbsetup"><span>Setup HB</span></a></li><li><a class="tocitem" href="#exc4_epmcres"><span>Test EPMC Residue</span></a></li><li><a class="tocitem" href="#exc4_cont"><span>Continuation</span></a></li><li><a class="tocitem" href="#exc4_plot"><span>Plotting</span></a></li></ul></li><li><a class="tocitem" href="../c5_mdofgen_newmark/">5: Transient Response of a 2DoF Hysteretic Oscillator using Newmark Scheme</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-4" type="checkbox"/><label class="tocitem" for="menuitem-2-4"><span class="docs-label">D: Bifurcation Analysis Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../d1_deflation/">1: Deflation to Locate Multiple roots</a></li><li><a class="tocitem" href="../d2_forcedvdp/">2: Bifurcation Analysis of the Forced Response of a Van der Pol Oscillator</a></li><li><a class="tocitem" href="../d3_normalform/">3: Branch Switching Using Normal Forms</a></li></ul></li><li><a class="tocitem" href="../e_febeam/">E: Finite Element Beam with Nonlinear Support</a></li><li><a class="tocitem" href="../reference/">Reference</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li><a class="is-disabled">C: Examples with the MDOFUTILS Suite</a></li><li class="is-active"><a href>4: Nonlinear Normal Modes of a 2DoF Hysteretic Oscillator using EPMC</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>4: Nonlinear Normal Modes of a 2DoF Hysteretic Oscillator using EPMC</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/Nidish96/juliajim" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/Nidish96/juliajim/blob/master/examples/c4_mdofgen_epmc.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="ex_c4"><a class="docs-heading-anchor" href="#ex_c4">Example C4: Nonlinear Normal Modes of a 2DoF Hysteretic Oscillator using the Extended Periodic Motion Concept</a><a id="ex_c4-1"></a><a class="docs-heading-anchor-permalink" href="#ex_c4" title="Permalink"></a></h1><div class="admonition is-info" id="The-Extended-Periodic-Motion-Concept-199a1a5b08b4e621"><header class="admonition-header">The Extended Periodic Motion Concept<a class="admonition-anchor" href="#The-Extended-Periodic-Motion-Concept-199a1a5b08b4e621" title="Permalink"></a></header><div class="admonition-body"><p>Nonlinear normal modes is a very succinct methodology for describing the dynamics of nonlinear systems. It leads to descriptions of the dynamics in terms of amplitude-dependent natural frequency, daming factor, and mode-shapes for each mode. The <a href="https://doi.org/10.1016/j.compstruc.2015.03.008">Extended Periodic Motion Concept</a> is a very popular methodology for capturing these numerically. The idea here is simple - it iteratively looks for what would be a linear self excitation (in terms of a negative viscous factor) that must be supplied to a system so that it has a periodic solution as an invariant set in its unforced state.</p><p>Mathematically the system we will be solving is:</p><p class="math-container">\[\mx{M} \ddot{\vc{u}} + \mx{C} \dot{\vc{u}} + \mx{K} \vc{u} + \vc{f_{nl}} = \xi \mx{M} \dot{\vc{u}}\]</p><p>where <span>$\xi$</span> controls the strength of the self-excitation. Since the system is always solved by the trivial solution, an amplitude constraint is often imposed. In order to simplify calculations later on, the first harmonic amplitude of the degrees of freedom is constrained as:</p><p class="math-container">\[\vc{U}_{c1}^T \mx{M} \vc{U}_{c1} + \vc{U}_{s1}^T \mx{M} \vc{U}_{s1} = a^2\]</p><p>where <span>$\vc{U}_{c1} = \frac{\Omega}{\pi} \int_0^{2\pi/\Omega} \vc{u} \cos\Omega t dt$</span> and <span>$\vc{U}_{s1} = \frac{\Omega}{\pi} \int_0^{2\pi/\Omega} \vc{u} \sin\Omega t dt$</span>. (a) is the user-specified amplitude, which serves as the continuation parameter in this context. In addition to this, there is still a phase indeterminacy present in the system. So we choose an arbitrary DoF (which is expected to be non-zero in the mode under consideration), and set its cosine harmonic to be zero (other constraints are also possible). With this, we will have a square system (same number of unknowns as equations) and it can be solved to obtain the amplitude-dependent nonlinear modal characteristics of the system.</p></div></div><p>The <a href="../reference/#juliajim.MDOFUTILS.EPMCRESFUN!-Tuple{Any, MDOFGEN, Any, Any, Int64}"><code>EPMCRESFUN!</code></a> routine in <a href="../reference/#juliajim.MDOFUTILS"><code>MDOFUTILS</code></a> implements the residue function for EPMC that can be used in tandem with <a href="../reference/#juliajim.CONTINUATION"><code>CONTINUATION</code></a> to obtain nonlinear modal characteristics. This example will illustrate this on the frictional 2DoF oscillator under consideration in Examples <a href="../c2_mdofgen_hystnl/#ex_c2">C2</a> and <a href="../c3_mdofgen_ahb/#ex_c3">C3</a>. The steps followed are:</p><ol><li><a href="#exc4_setup">First</a> the system is setup (along with the nonlinearity, see descriptions in <a href="../c2_mdofgen_hystnl/#exc2_setup">Example C2</a>.</li><li><a href="#exc4_linmodal">Next</a> we conduct linear modal analysis on the linearized system. This is important to set the initial guess for the EPMC run next.</li><li><a href="#exc4_hbsetup">Now</a> we setup the Harmonic Balance parameters and then <a href="#exc4_epmcres">test out the EPMC residue routine</a> using the linearized modes estimated above.</li><li><a href="#exc4_cont">Finally</a> we conduct the contuation over the modal amplitude (a) and then <a href="#exc4_plot">visualize</a> the results.</li></ol><h2 id="Preamble:-Load-Packages"><a class="docs-heading-anchor" href="#Preamble:-Load-Packages">Preamble: Load Packages</a><a id="Preamble:-Load-Packages-1"></a><a class="docs-heading-anchor-permalink" href="#Preamble:-Load-Packages" title="Permalink"></a></h2><pre><code class="language-julia hljs">using GLMakie
using LinearAlgebra
using SparseArrays
using ForwardDiff
using NonlinearSolve
using DSP

using juliajim.HARMONIC
using juliajim.CONTINUATION
using juliajim.MDOFUTILS</code></pre><h2 id="exc4_setup"><a class="docs-heading-anchor" href="#exc4_setup">System Setup</a><a id="exc4_setup-1"></a><a class="docs-heading-anchor-permalink" href="#exc4_setup" title="Permalink"></a></h2><p>MCK matrices and nonlinearity setup: identical to <a href="../c2_mdofgen_hystnl/#exc2_setup">Example C2</a>.</p><pre><code class="language-julia hljs">M = collect(1.0I(2));
K = [2. -1.;-1. 2.];
C = 0.01*M+0.001*K;

mdl = MDOFGEN(M, C, K);

# Nonlinearity
kt = 1.0;
fs = 1.0;
fnl = (t,u,up,fp)-&gt; if all(abs.(fp+kt*(u-up)).&lt;fs)
    return fp+kt*(u-up), kt*ones(size(u)), -kt*ones(size(u)), ones(size(u)); else
        return fs*sign.(fp+kt*(u-up)), zeros(size(u)), zeros(size(u)), zeros(size(u));
end
L = [0.0 1.0];

mdl = ADDNL(mdl, :Hyst, fnl, L);</code></pre><h2 id="exc4_linmodal"><a class="docs-heading-anchor" href="#exc4_linmodal">Linear Modal Analysis</a><a id="exc4_linmodal-1"></a><a class="docs-heading-anchor-permalink" href="#exc4_linmodal" title="Permalink"></a></h2><p>Remember that in the limit of small amplitude, the Jenkins element acts like a linear spring. So we add this additional stiffness to the linearized stiffness matrix and conduct the modal analysis (eigen decomposition). The mode shapes, natural frequencies, and damping are saved since these will be used next as the initial guess for EPMC.</p><pre><code class="language-julia hljs">Knl0 = L&#39;kt*L;
K0 = mdl.K+Knl0;
D, V = eigen(K0, mdl.M)
W0s = sqrt.(D);
Xis = diag(V&#39;mdl.C*V)

mi = 1;  # Mode of interest</code></pre><h2 id="exc4_hbsetup"><a class="docs-heading-anchor" href="#exc4_hbsetup">Setup HB</a><a id="exc4_hbsetup-1"></a><a class="docs-heading-anchor-permalink" href="#exc4_hbsetup" title="Permalink"></a></h2><p>Setting up parameters for Harmonic Balance: identical to <a href="../c2_mdofgen_hystnl/#exc2_setup">Example C2</a>.</p><pre><code class="language-julia hljs">h = 0:5;
N = 256;
t = (0:N-1)*2π/N;

Nhc = sum(all(h.==0, dims=2) + 2any(h.!=0, dims=2));

_, _, zinds, rinds, iinds = HINDS(mdl.Ndofs, h)
Fl = zeros(Nhc*mdl.Ndofs);
Fl[rinds[1]] = 1.0;

E, dEdw = HARMONICSTIFFNESS(mdl.M, mdl.C, mdl.K, W0s[mi], h);

U0 = zeros(mdl.Ndofs*Nhc);
U0[iinds[1:mdl.Ndofs]] = V[:, mi];</code></pre><h2 id="exc4_epmcres"><a class="docs-heading-anchor" href="#exc4_epmcres">Test EPMC Residue</a><a id="exc4_epmcres-1"></a><a class="docs-heading-anchor-permalink" href="#exc4_epmcres" title="Permalink"></a></h2><p>The ordering of unknowns that will be sent to the <a href="../reference/#juliajim.MDOFUTILS.EPMCRESFUN!-Tuple{Any, MDOFGEN, Any, Any, Int64}"><code>EPMCRESFUN!</code></a> routine is (\begin{bmatrix} \vc{u}^T&amp;\omega&amp;\xi&amp;\log_{10}(a) \end{bmatrix}^T), where the last parameter is the log of the amplitude (base 10). The log-scaling is done on the amplitude to help with numerical conditioning issues.</p><p>In the following we setup everything and test it to ensure that the residue can be used to converge to the solution.</p><pre><code class="language-julia hljs">R = zeros(mdl.Ndofs*Nhc+2);
dRdU = zeros(mdl.Ndofs*Nhc+2, mdl.Ndofs*Nhc+2);
dRda = zeros(mdl.Ndofs*Nhc+2);

EPMCRESFUN!([U0; W0s[mi]; Xis[mi]; -2], mdl, Fl, h, N; R=R, dRdUwx=dRdU, dRda=dRda)

A0 = -2.0;

U0 = zeros(mdl.Ndofs*Nhc);
U0[iinds[1:mdl.Ndofs]] = V[:, mi];

fun = NonlinearFunction((r,uwx,p)-&gt;EPMCRESFUN!([uwx;p], mdl, Fl, h, N; R=r),
    jac=(J,uwx,p)-&gt;EPMCRESFUN!([uwx;p], mdl, Fl, h, N; dRdUwx=J),
    paramjac=(Jp,uwx,p)-&gt;EPMCRESFUN!([uwx;p], mdl, Fl, h, N; dRda=Jp));

prob = NonlinearProblem(fun, [U0;W0s[mi];Xis[mi]], A0);
sol = solve(prob, show_trace=Val(true), maxiters=100);</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">
Algorithm: NewtonRaphson(
    descent = NewtonDescent(),
    autodiff = AutoForwardDiff(),
    vjp_autodiff = AutoFiniteDiff(
        fdtype = Val{:forward}(),
        fdjtype = Val{:forward}(),
        fdhtype = Val{:hcentral}(),
        dir = true
    ),
    jvp_autodiff = AutoForwardDiff(),
    concrete_jac = Val{false}()
)

----    	-------------       	-----------
Iter    	f(u) inf-norm       	Step 2-norm
----    	-------------       	-----------
0       	4.47213595e-06      	NaN
1       	7.63931298e-08      	2.76393076e-04
2       	1.33226763e-15      	3.81965696e-08
Final   	1.33226763e-15
----------------------</code></pre><h2 id="exc4_cont"><a class="docs-heading-anchor" href="#exc4_cont">Continuation</a><a id="exc4_cont-1"></a><a class="docs-heading-anchor-permalink" href="#exc4_cont" title="Permalink"></a></h2><p>Now we are ready to conduct continuation to obtain the amplitude dependent resonance backbone for the system. The invocation of <a href="../reference/#juliajim.CONTINUATION.CONTINUATE-Tuple{Vector{Float64}, Any, Vector{Float64}, Float64}"><code>CONTINUATE</code></a> is exactly as encountered in the earlier examples.</p><pre><code class="language-julia hljs">A0 = -1.;
A1 = 3.;
da = 0.05;
cpars = (nmax=1000, Dsc=:auto, angopt=deg2rad(30));

sols, its, dss, xis, Dsc = CONTINUATE([U0;W0s[mi];Xis[mi]], fun, [A0, A1], da; cpars...);

uh = zeros(Complex, maximum(h)+1, length(sols), 2);
for i in 1:2
    uh[h.+1, :, i] = hcat([[s.up[zinds[i:2:end]];
                            s.up[rinds[i:2:end]]+1im*s.up[iinds[i:2:end]]]
                          for s in sols]...);
end
Oms = [s.up[end-2] for s in sols];
Zts = [s.up[end-1] for s in sols]./2Oms;
As = [10^s.up[end] for s in sols];</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">
Algorithm: NewtonRaphson(
    descent = NewtonDescent(),
    autodiff = AutoForwardDiff(),
    vjp_autodiff = AutoFiniteDiff(
        fdtype = Val{:forward}(),
        fdjtype = Val{:forward}(),
        fdhtype = Val{:hcentral}(),
        dir = true
    ),
    jvp_autodiff = AutoForwardDiff(),
    concrete_jac = Val{false}()
)

----    	-------------       	-----------
Iter    	f(u) inf-norm       	Step 2-norm
----    	-------------       	-----------
0       	4.47213595e-05      	0.00000000e+00
1       	7.63931298e-08      	2.76393076e-04
Final   	7.63931298e-08
----------------------
2. -0.95 with step 0.0500 (0.0500) converged in 1 iterations. 19.106334 Δα.
3. -0.91 with step 0.0366 (0.0375) converged in 1 iterations. 25.371544 Δα.
4. -0.89 with step 0.0265 (0.0281) converged in 1 iterations. 3.942536 Δα.
5. -0.87 with step 0.0193 (0.0211) converged in 1 iterations. 43.711935 Δα.
6. -0.85 with step 0.0141 (0.0158) converged in 1 iterations. 58.218871 Δα.
7. -0.84 with step 0.0103 (0.0119) converged in 1 iterations. 8.686789 Δα.
8. -0.83 with step 0.0086 (0.0100) converged in 1 iterations. 0.259320 Δα.
9. -0.82 with step 0.0102 (0.0121) converged in 1 iterations. 6.607028 Δα.
10. -0.82 with step 0.0084 (0.0100) converged in 1 iterations. 2.650001 Δα.
11. -0.81 with step 0.0083 (0.0100) converged in 1 iterations. 94.079119 Δα.
12. -0.80 with step 0.0082 (0.0100) converged in 1 iterations. 10.988335 Δα.
13. -0.79 with step 0.0081 (0.0100) converged in 1 iterations. 12.520995 Δα.
14. -0.78 with step 0.0080 (0.0100) converged in 1 iterations. 13.607207 Δα.
15. -0.78 with step 0.0079 (0.0100) converged in 1 iterations. 15.498001 Δα.
16. -0.77 with step 0.0078 (0.0100) converged in 1 iterations. 94.608058 Δα.
17. -0.76 with step 0.0078 (0.0100) converged in 1 iterations. 0.000000 Δα.
18. -0.75 with step 0.0115 (0.0150) converged in 1 iterations. 0.000000 Δα.
19. -0.73 with step 0.0171 (0.0225) converged in 1 iterations. 0.000000 Δα.
20. -0.71 with step 0.0251 (0.0338) converged in 1 iterations. 26.497499 Δα.
21. -0.69 with step 0.0184 (0.0253) converged in 1 iterations. 4.698981 Δα.
22. -0.67 with step 0.0134 (0.0190) converged in 1 iterations. 50.101460 Δα.
23. -0.66 with step 0.0098 (0.0142) converged in 1 iterations. 2.779557 Δα.
24. -0.66 with step 0.0072 (0.0107) converged in 1 iterations. 0.466835 Δα.
25. -0.65 with step 0.0073 (0.0110) converged in 1 iterations. 84.690288 Δα.
26. -0.64 with step 0.0066 (0.0100) converged in 1 iterations. 94.135121 Δα.
27. -0.64 with step 0.0065 (0.0100) converged in 1 iterations. 0.000000 Δα.
28. -0.63 with step 0.0097 (0.0150) converged in 1 iterations. 0.000000 Δα.
29. -0.61 with step 0.0143 (0.0225) converged in 1 iterations. 0.000000 Δα.
30. -0.59 with step 0.0211 (0.0338) converged in 1 iterations. 0.000000 Δα.
31. -0.56 with step 0.0308 (0.0506) converged in 1 iterations. 4.564318 Δα.
32. -0.54 with step 0.0222 (0.0380) converged in 1 iterations. 0.000000 Δα.
33. -0.51 with step 0.0320 (0.0570) converged in 1 iterations. 4.808186 Δα.
34. -0.48 with step 0.0228 (0.0427) converged in 1 iterations. 0.000000 Δα.
35. -0.45 with step 0.0326 (0.0641) converged in 1 iterations. 0.000000 Δα.
36. -0.41 with step 0.0461 (0.0961) converged in 1 iterations. 2.213660 Δα.
37. -0.37 with step 0.0318 (0.0721) converged in 1 iterations. 0.000000 Δα.
38. -0.33 with step 0.0439 (0.1081) converged in 1 iterations. 8.090315 Δα.
39. -0.30 with step 0.0297 (0.0811) converged in 1 iterations. 11.933280 Δα.
40. -0.28 with step 0.0202 (0.0608) converged in 1 iterations. 0.728620 Δα.
41. -0.26 with step 0.0171 (0.0562) converged in 1 iterations. 16.483485 Δα.
42. -0.25 with step 0.0119 (0.0421) converged in 1 iterations. 22.481624 Δα.
43. -0.24 with step 0.0084 (0.0316) converged in 1 iterations. 3.519582 Δα.
44. -0.24 with step 0.0060 (0.0237) converged in 1 iterations. 2.231908 Δα.
45. -0.23 with step 0.0044 (0.0178) converged in 1 iterations. 10.935623 Δα.
46. -0.23 with step 0.0032 (0.0133) converged in 1 iterations. 0.000000 Δα.
47. -0.22 with step 0.0047 (0.0200) converged in 1 iterations. 8.644623 Δα.
48. -0.22 with step 0.0034 (0.0150) converged in 1 iterations. 0.000000 Δα.
49. -0.22 with step 0.0051 (0.0225) converged in 1 iterations. 6.637659 Δα.
50. -0.21 with step 0.0037 (0.0169) converged in 1 iterations. 15.765170 Δα.
51. -0.21 with step 0.0027 (0.0127) converged in 1 iterations. 0.000000 Δα.
52. -0.21 with step 0.0040 (0.0190) converged in 1 iterations. 12.972662 Δα.
53. -0.20 with step 0.0030 (0.0142) converged in 1 iterations. 0.000000 Δα.
54. -0.20 with step 0.0044 (0.0214) converged in 1 iterations. 44.480520 Δα.
55. -0.19 with step 0.0032 (0.0160) converged in 1 iterations. 2.994786 Δα.
56. -0.19 with step 0.0024 (0.0120) converged in 1 iterations. 8.048280 Δα.
57. -0.19 with step 0.0020 (0.0100) converged in 1 iterations. 18.036131 Δα.
58. -0.19 with step 0.0019 (0.0100) converged in 1 iterations. 18.849739 Δα.
59. -0.19 with step 0.0019 (0.0100) converged in 1 iterations. 19.621421 Δα.
60. -0.18 with step 0.0019 (0.0100) converged in 1 iterations. 20.120851 Δα.
61. -0.18 with step 0.0019 (0.0100) converged in 1 iterations. 20.767501 Δα.
62. -0.18 with step 0.0018 (0.0100) converged in 1 iterations. 21.373011 Δα.
63. -0.18 with step 0.0018 (0.0100) converged in 1 iterations. 22.076420 Δα.
64. -0.18 with step 0.0018 (0.0100) converged in 1 iterations. 22.724488 Δα.
65. -0.18 with step 0.0018 (0.0100) converged in 1 iterations. 23.226697 Δα.
66. -0.17 with step 0.0018 (0.0100) converged in 1 iterations. 23.937969 Δα.
67. -0.17 with step 0.0018 (0.0100) converged in 1 iterations. 24.456180 Δα.
68. -0.17 with step 0.0017 (0.0100) converged in 1 iterations. 25.012873 Δα.
69. -0.17 with step 0.0017 (0.0100) converged in 1 iterations. 95.179038 Δα.
70. -0.17 with step 0.0017 (0.0100) converged in 1 iterations. 95.237720 Δα.
71. -0.17 with step 0.0017 (0.0100) converged in 1 iterations. 0.000000 Δα.
72. -0.16 with step 0.0025 (0.0150) converged in 1 iterations. 0.000000 Δα.
73. -0.16 with step 0.0037 (0.0225) converged in 1 iterations. 0.000000 Δα.
74. -0.15 with step 0.0055 (0.0338) converged in 1 iterations. 0.000000 Δα.
75. -0.15 with step 0.0080 (0.0506) converged in 1 iterations. 18.752079 Δα.
76. -0.14 with step 0.0058 (0.0380) converged in 1 iterations. 3.351260 Δα.
77. -0.14 with step 0.0041 (0.0285) converged in 1 iterations. 1.027484 Δα.
78. -0.13 with step 0.0034 (0.0244) converged in 1 iterations. 2.524004 Δα.
79. -0.13 with step 0.0025 (0.0183) converged in 1 iterations. 10.763983 Δα.
80. -0.13 with step 0.0018 (0.0137) converged in 1 iterations. 0.000000 Δα.
81. -0.13 with step 0.0027 (0.0206) converged in 1 iterations. 8.431895 Δα.
82. -0.12 with step 0.0020 (0.0154) converged in 1 iterations. 0.000000 Δα.
83. -0.12 with step 0.0029 (0.0232) converged in 1 iterations. 6.218238 Δα.
84. -0.12 with step 0.0021 (0.0174) converged in 1 iterations. 15.014825 Δα.
85. -0.12 with step 0.0016 (0.0130) converged in 1 iterations. 0.000000 Δα.
86. -0.11 with step 0.0023 (0.0195) converged in 1 iterations. 12.157691 Δα.
87. -0.11 with step 0.0017 (0.0147) converged in 1 iterations. 0.000000 Δα.
88. -0.11 with step 0.0025 (0.0220) converged in 1 iterations. 9.569287 Δα.
89. -0.11 with step 0.0019 (0.0165) converged in 1 iterations. 0.000000 Δα.
90. -0.11 with step 0.0027 (0.0247) converged in 1 iterations. 7.428921 Δα.
91. -0.10 with step 0.0020 (0.0186) converged in 1 iterations. 0.000000 Δα.
92. -0.10 with step 0.0029 (0.0278) converged in 1 iterations. 5.662433 Δα.
93. -0.10 with step 0.0022 (0.0209) converged in 1 iterations. 45.672674 Δα.
94. -0.10 with step 0.0016 (0.0157) converged in 1 iterations. 0.000000 Δα.
95. -0.09 with step 0.0023 (0.0235) converged in 1 iterations. 0.000000 Δα.
96. -0.09 with step 0.0034 (0.0352) converged in 1 iterations. 0.000000 Δα.
97. -0.09 with step 0.0050 (0.0528) converged in 1 iterations. 18.372960 Δα.
98. -0.08 with step 0.0036 (0.0396) converged in 1 iterations. 6.405386 Δα.
99. -0.08 with step 0.0026 (0.0297) converged in 1 iterations. 0.000000 Δα.
100. -0.08 with step 0.0037 (0.0446) converged in 1 iterations. 5.564729 Δα.
101. -0.07 with step 0.0027 (0.0334) converged in 1 iterations. 0.000000 Δα.
102. -0.07 with step 0.0038 (0.0501) converged in 1 iterations. 4.774401 Δα.
103. -0.07 with step 0.0028 (0.0376) converged in 1 iterations. 0.000000 Δα.
104. -0.06 with step 0.0040 (0.0564) converged in 1 iterations. 4.181333 Δα.
105. -0.06 with step 0.0028 (0.0423) converged in 1 iterations. 22.513277 Δα.
106. -0.06 with step 0.0020 (0.0317) converged in 1 iterations. 29.950842 Δα.
107. -0.06 with step 0.0014 (0.0238) converged in 1 iterations. 0.000000 Δα.
108. -0.05 with step 0.0021 (0.0357) converged in 1 iterations. 0.000000 Δα.
109. -0.05 with step 0.0030 (0.0535) converged in 1 iterations. 0.000000 Δα.
110. -0.05 with step 0.0044 (0.0803) converged in 1 iterations. 0.000000 Δα.
111. -0.04 with step 0.0061 (0.1205) converged in 1 iterations. 0.000000 Δα.
112. -0.03 with step 0.0083 (0.1807) converged in 1 iterations. 1.329891 Δα.
113. -0.03 with step 0.0057 (0.1471) converged in 1 iterations. 0.000000 Δα.
114. -0.02 with step 0.0072 (0.2206) converged in 1 iterations. 0.000000 Δα.
115. -0.01 with step 0.0064 (0.2500) converged in 1 iterations. 0.000000 Δα.
116. -0.01 with step 0.0047 (0.2500) converged in 1 iterations. 0.000000 Δα.
117. -0.01 with step 0.0033 (0.2500) converged in 1 iterations. 0.000000 Δα.
118. -0.00 with step 0.0022 (0.2500) converged in 1 iterations. 3.803975 Δα.
119. -0.00 with step 0.0012 (0.1875) converged in 1 iterations. 0.000000 Δα.
120. -0.00 with step 0.0013 (0.2500) converged in 1 iterations. 3.813957 Δα.
121. -0.00 with step 0.0007 (0.1875) converged in 1 iterations. 0.000000 Δα.
122. 0.00 with step 0.0005 (0.2500) converged in 1 iterations. 0.000000 Δα.
123. 0.00 with step 0.0003 (0.2500) converged in 1 iterations. 0.000000 Δα.
124. 0.00 with step 0.0006 (0.2500) converged in 1 iterations. 0.000000 Δα.
125. 0.00 with step 0.0009 (0.2500) converged in 1 iterations. 0.000000 Δα.
126. 0.00 with step 0.0012 (0.2500) converged in 1 iterations. 0.000000 Δα.
127. 0.00 with step 0.0015 (0.2500) converged in 1 iterations. 0.000000 Δα.
128. 0.01 with step 0.0018 (0.2500) converged in 1 iterations. 0.000000 Δα.
129. 0.01 with step 0.0022 (0.2500) converged in 1 iterations. 0.000000 Δα.
130. 0.01 with step 0.0025 (0.2500) converged in 1 iterations. 0.000000 Δα.
131. 0.01 with step 0.0029 (0.2500) converged in 1 iterations. 0.000000 Δα.
132. 0.02 with step 0.0032 (0.2500) converged in 1 iterations. 0.000000 Δα.
133. 0.02 with step 0.0037 (0.2500) converged in 1 iterations. 1.086655 Δα.
134. 0.02 with step 0.0037 (0.2118) converged in 1 iterations. 0.000000 Δα.
135. 0.03 with step 0.0052 (0.2500) converged in 1 iterations. 0.633224 Δα.
136. 0.04 with step 0.0060 (0.2387) converged in 1 iterations. 0.457420 Δα.
137. 0.04 with step 0.0074 (0.2470) converged in 1 iterations. 0.088704 Δα.
138. 0.05 with step 0.0090 (0.2500) converged in 1 iterations. 0.232131 Δα.
139. 0.06 with step 0.0109 (0.2500) converged in 1 iterations. 0.588406 Δα.
140. 0.08 with step 0.0127 (0.2429) converged in 1 iterations. 0.466126 Δα.
141. 0.09 with step 0.0158 (0.2500) converged in 1 iterations. 0.153124 Δα.
142. 0.11 with step 0.0190 (0.2500) converged in 1 iterations. 0.132327 Δα.
143. 0.13 with step 0.0229 (0.2500) converged in 1 iterations. 0.330820 Δα.
144. 0.16 with step 0.0277 (0.2500) converged in 1 iterations. 0.127950 Δα.
145. 0.19 with step 0.0334 (0.2500) converged in 1 iterations. 0.101496 Δα.
146. 0.23 with step 0.0403 (0.2500) converged in 1 iterations. 0.223694 Δα.
147. 0.28 with step 0.0487 (0.2500) converged in 3 iterations. 3.821266 Δα.
148. 0.29 with step 0.0076 (0.1347) converged in 1 iterations. 0.011763 Δα.
149. 0.30 with step 0.0117 (0.2020) converged in 2 iterations. 0.013987 Δα.
150. 0.32 with step 0.0151 (0.2500) converged in 2 iterations. 0.041034 Δα.
151. 0.33 with step 0.0160 (0.2500) converged in 2 iterations. 0.060826 Δα.
152. 0.35 with step 0.0174 (0.2500) converged in 2 iterations. 0.077925 Δα.
153. 0.37 with step 0.0191 (0.2500) converged in 2 iterations. 0.110655 Δα.
154. 0.40 with step 0.0221 (0.2500) converged in 2 iterations. 0.133729 Δα.
155. 0.42 with step 0.0268 (0.2500) converged in 2 iterations. 0.183922 Δα.
156. 0.47 with step 0.0362 (0.2500) converged in 2 iterations. 0.051297 Δα.
157. 0.54 with step 0.0556 (0.2500) converged in 3 iterations. 0.129569 Δα.
158. 0.65 with step 0.0998 (0.2500) converged in 4 iterations. 0.275533 Δα.
159. 0.75 with step 0.1130 (0.2348) converged in 3 iterations. 0.315666 Δα.
160. 0.85 with step 0.0987 (0.2190) converged in 2 iterations. 0.331804 Δα.
161. 0.95 with step 0.0978 (0.2150) converged in 2 iterations. 0.098330 Δα.
162. 1.07 with step 0.1163 (0.2500) converged in 2 iterations. 0.137070 Δα.
163. 1.21 with step 0.1366 (0.2500) converged in 2 iterations. 0.190715 Δα.
164. 1.40 with step 0.1693 (0.2500) converged in 3 iterations. 0.316485 Δα.
165. 1.63 with step 0.2099 (0.2329) converged in 3 iterations. 0.435140 Δα.
166. 1.88 with step 0.2346 (0.1950) converged in 3 iterations. 0.589255 Δα.
167. 2.11 with step 0.2252 (0.1482) converged in 3 iterations. 0.745271 Δα.
168. 2.30 with step 0.1887 (0.1049) converged in 2 iterations. 0.901164 Δα.
169. 2.46 with step 0.1568 (0.0771) converged in 2 iterations. 1.037338 Δα.
170. 2.58 with step 0.1220 (0.0546) converged in 2 iterations. 1.156758 Δα.
171. 2.67 with step 0.0904 (0.0377) converged in 2 iterations. 1.222713 Δα.
172. 2.73 with step 0.0648 (0.0257) converged in 2 iterations. 1.337874 Δα.
173. 2.78 with step 0.0449 (0.0171) converged in 1 iterations. 1.398620 Δα.
174. 2.82 with step 0.0372 (0.0138) converged in 1 iterations. 1.444077 Δα.
175. 2.85 with step 0.0304 (0.0110) converged in 1 iterations. 1.477752 Δα.
176. 2.87 with step 0.0280 (0.0100) converged in 1 iterations. 1.502467 Δα.
177. 2.90 with step 0.0283 (0.0100) converged in 1 iterations. 1.521581 Δα.
178. 2.93 with step 0.0287 (0.0100) converged in 1 iterations. 1.538782 Δα.
179. 2.96 with step 0.0290 (0.0100) converged in 1 iterations. 1.555091 Δα.
180. 2.99 with step 0.0293 (0.0100) converged in 1 iterations. 1.571018 Δα.
181. 3.02 with step 0.0296 (0.0100) converged in 1 iterations. 1.586819 Δα.</code></pre><h2 id="exc4_plot"><a class="docs-heading-anchor" href="#exc4_plot">Plotting</a><a id="exc4_plot-1"></a><a class="docs-heading-anchor-permalink" href="#exc4_plot" title="Permalink"></a></h2><p>Finally we visualize the results in terms of harmonics as well as in terms of natural frequency and (equivalent) damping factor characteristic curves.</p><pre><code class="language-julia hljs">his = [1, 3, 5];

set_theme!(theme_latexfonts());
fsz = 20;
fig = Figure(fontsize=fsz, size=(1000, 600));

axs = [];
for i in eachindex(his[his.&lt;=maximum(h)])
    ax = Axis(fig[1, i],
        ylabel=L&quot;$H_%$(his[i])$ Response (m)&quot;, xscale=log10, yscale=log10);
    scatterlines!(ax, As, abs.(uh[his[i].+1, :, 1]), label=&quot;x1&quot;);
    scatterlines!(ax, As, abs.(uh[his[i].+1, :, 2]), label=&quot;x2&quot;);
    push!(axs, ax)

    ax = Axis(fig[2, i], xlabel=L&quot;Modal Amplitude $a$&quot;,
        ylabel=L&quot;$H_%$(his[i])$ Phase (rad)&quot;, xscale=log10);
    scatterlines!(ax, As, unwrap(angle.(uh[his[i].+1, :, 1])), label=&quot;x1&quot;);
    scatterlines!(ax, As, unwrap(angle.(uh[his[i].+1, :, 2])), label=&quot;x2&quot;);
    push!(axs, ax)
    if i==1
        axislegend(ax)
    end
end
ax = Axis(fig[1, length(his)+1],
    ylabel=L&quot;Natural Frequency $\omega_n$ (rad/s)&quot;, xscale=log10);
scatterlines!(ax, As, Oms);
push!(axs, ax)

ax = Axis(fig[2, length(his)+1], xlabel=L&quot;Modal Amplitude $a$&quot;,
    ylabel=&quot;Damping Factor (%)&quot;, xscale=log10);
scatterlines!(ax, As, 100Zts);
push!(axs, ax)

linkxaxes!(axs...)

    fig</code></pre><img src="7f653bb2.png" alt="Example block output"/><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../c3_mdofgen_ahb/">« 3: Response Constrained Forced Response of a 2DoF Hysteretic Oscillator</a><a class="docs-footer-nextpage" href="../c5_mdofgen_newmark/">5: Transient Response of a 2DoF Hysteretic Oscillator using Newmark Scheme »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Saturday 10 January 2026 18:25">Saturday 10 January 2026</span>. Using Julia version 1.12.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
