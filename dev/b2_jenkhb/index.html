<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>2: Frictional Oscillator · juliajim</title><meta name="title" content="2: Frictional Oscillator · juliajim"/><meta property="og:title" content="2: Frictional Oscillator · juliajim"/><meta property="twitter:title" content="2: Frictional Oscillator · juliajim"/><meta name="description" content="Documentation for juliajim."/><meta property="og:description" content="Documentation for juliajim."/><meta property="twitter:description" content="Documentation for juliajim."/><meta property="og:url" content="https://github.com/Nidish96/juliajim/b2_jenkhb/"/><meta property="twitter:url" content="https://github.com/Nidish96/juliajim/b2_jenkhb/"/><link rel="canonical" href="https://github.com/Nidish96/juliajim/b2_jenkhb/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/custom.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">juliajim</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../a_hworld/">A: Harmonic Utilities</a></li><li><input class="collapse-toggle" id="menuitem-2-2" type="checkbox" checked/><label class="tocitem" for="menuitem-2-2"><span class="docs-label">B: Numerical Continuation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../b1_duffhb/">1: Duffing Oscillator</a></li><li class="is-active"><a class="tocitem" href>2: Frictional Oscillator</a><ul class="internal"><li><a class="tocitem" href="#Preamble:-Load-Packages"><span>Preamble: Load Packages</span></a></li><li><a class="tocitem" href="#exb2_res"><span>Define Residue Function</span></a></li><li><a class="tocitem" href="#exb2_setup"><span>Setup</span></a></li><li><a class="tocitem" href="#exb2_cont"><span>Continuation</span></a></li><li><a class="tocitem" href="#exb2_plot"><span>Plotting</span></a></li><li><a class="tocitem" href="#exb2_outro"><span>Outro</span></a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-3" type="checkbox"/><label class="tocitem" for="menuitem-2-3"><span class="docs-label">C: Examples with the MDOFUTILS Suite</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../c1_mdofgen_instnl/">1: Forced Response of a 2DoF Oscillator with Instantaneous Nonlinearity</a></li><li><a class="tocitem" href="../c2_mdofgen_hystnl/">2: Forced Response of a 2DoF Oscillator with Hysteretic Nonlinearity</a></li><li><a class="tocitem" href="../c3_mdofgen_ahb/">3: Response Constrained Forced Response of a 2DoF Hysteretic Oscillator</a></li><li><a class="tocitem" href="../c4_mdofgen_epmc/">4: Nonlinear Normal Modes of a 2DoF Hysteretic Oscillator using EPMC</a></li><li><a class="tocitem" href="../c5_mdofgen_newmark/">5: Transient Response of a 2DoF Hysteretic Oscillator using Newmark Scheme</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-4" type="checkbox"/><label class="tocitem" for="menuitem-2-4"><span class="docs-label">D: Bifurcation Analysis Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../d1_deflation/">1: Deflation to Locate Multiple roots</a></li><li><a class="tocitem" href="../d2_forcedvdp/">2: Bifurcation Analysis of the Forced Response of a Van der Pol Oscillator</a></li><li><a class="tocitem" href="../d3_normalform/">3: Branch Switching Using Normal Forms</a></li></ul></li><li><a class="tocitem" href="../e_febeam/">E: Finite Element Beam with Nonlinear Support</a></li><li><a class="tocitem" href="../reference/">Reference</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li><a class="is-disabled">B: Numerical Continuation</a></li><li class="is-active"><a href>2: Frictional Oscillator</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>2: Frictional Oscillator</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/Nidish96/juliajim/blob/master/examples/b2_jenkhb.jl#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="ex_b2"><a class="docs-heading-anchor" href="#ex_b2">Example B2: Numerical Continuation on a Frictional Oscillator</a><a id="ex_b2-1"></a><a class="docs-heading-anchor-permalink" href="#ex_b2" title="Permalink"></a></h1><p>The scope as well as the approach of this example are very similar to <a href="../b1_duffhb/#ex_b1">Example b1</a>, with a key difference: this example involves a hysteretic nonlinearity. This poses a very important difference in how the nonlinear force and its harmonics are computed.</p><p>The general setup for the problem is similar:</p><p class="math-container">\[\ddot{x} + 2\zeta_0\omega_0\dot{x} + \omega_0^2 x + f_{nl} = F\cos\Omega t.\]</p><p>The nonlinearity <span>$f_{nl}$</span> is a hysteretically saturated linear spring with low amplitude stiffness <span>$k_t$</span> and saturation limit (&quot;slip&quot; force) <span>$f_s$</span>.</p><p>The steps that will be followed in this file are exactly the same as in <a href="../b1_duffhb/#ex_b1">Example b1</a>:</p><ol><li><a href="#exb2_res">First</a> we define a &quot;harmonic residue&quot; function for the Duffing oscillator in a way that returns the residue, its Jacobian with respect to the vector of harmonics (see <a href="../a_hworld/#ex_a"><code>Example a</code></a>), and also with respect to the excitation frequency.</li><li><a href="#exb2_setup">Next</a> we define the parameters for the problem and setup the necessary variables for the Harmonic Balance (and AFT).</li><li><a href="#exb2_cont">Then</a> we conduct the actual continuation after setting up parameters for this.</li><li><a href="#exb2_plot">Finally</a> the results are plotted in terms of the different harmonics present.</li></ol><h2 id="Preamble:-Load-Packages"><a class="docs-heading-anchor" href="#Preamble:-Load-Packages">Preamble: Load Packages</a><a id="Preamble:-Load-Packages-1"></a><a class="docs-heading-anchor-permalink" href="#Preamble:-Load-Packages" title="Permalink"></a></h2><pre><code class="language-julia hljs">using GLMakie
using LaTeXStrings
using LinearAlgebra
using NonlinearSolve
using ForwardDiff
using DSP

using juliajim.HARMONIC
using juliajim.CONTINUATION</code></pre><h2 id="exb2_res"><a class="docs-heading-anchor" href="#exb2_res">Define Residue Function</a><a id="exb2_res-1"></a><a class="docs-heading-anchor-permalink" href="#exb2_res" title="Permalink"></a></h2><p>The structure of the residue function is identical to that in <a href="../b1_duffhb/#exb1_res">Example 1</a>. A key differerence is in the computation of the nonlinear force.</p><p>Unlike in the previous case, the restoring force of a hysteretic element can not be estimated at any instant of time independent of its history. In other words, the restoring force of a hysteretic element can be different based on its loading history. For steady state calculations, we start by assuming initially that the hysteretic element acts as a linear spring (see <code>ft=kt*ut</code> below) and then &quot;march forward&quot; in time. At each instant the incremental form of the friction law is used to check if saturation is violated and the restoring force is corrected appropriately. The force &quot;shakes down&quot; after repeating this for 2 or more cycles of the period. We use this steady-state force for the Fourier transforms involve in Harmonic Balance.</p><pre><code class="language-julia hljs">function RESFUN!(Uw, Fl, pars, h, Nt; R=nothing, dRdU=nothing, dRdw=nothing)
    (; z0, w0, kt, fs, F) = pars;

    Om = Uw[end];
    Nhc = sum((h.==0)+2(h.!=0));

    # Linear Portion
    E, dEdw = HARMONICSTIFFNESS(1.0, 2z0*w0, w0^2, Om, h);

    # AFT For nonlinear force
    ut  = AFT(Uw[1:end-1], h, Nt, :f2t);

    # Construct Residue
    if !(R === nothing &amp;&amp; dRdU === nothing)
        ft = kt*ut;
        if !(dRdU === nothing)
            cst = AFT(eltype(Uw).(I(Nhc)), h, Nt, :f2t);
            dfdat = kt.*cst;
        end

        for _ in 1:2
            for (ti, tim1) in zip(1:Nt, circshift(1:Nt,1))
                fsp = kt*(ut[ti]-ut[tim1]) + ft[tim1];  # stick prediction
                ft[ti] = clamp(fsp, -fs, fs);
                if !(dRdU === nothing)
                    if (abs(fsp)&lt;fs)
                        dfdat[ti, :] = kt.*(cst[ti,:]-cst[tim1,:]) + dfdat[tim1,:];
                    else
                        dfdat[ti, :] .= 0.0;
                    end
                end
            end
        end
        if !(R === nothing)
            Fnl = AFT(ft, h, Nt, :t2f);
            R[:] = E*Uw[1:end-1] + Fnl - Fl*F;
        end
        if !(dRdU === nothing)
            Jnl    = AFT(dfdat, h, Nt, :t2f);
            dRdU[:, :] = E + Jnl;
        end
    end
    if !(dRdw === nothing)
        dRdw[:] = dEdw*Uw[1:end-1];
    end
    return nothing;
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">RESFUN! (generic function with 1 method)</code></pre><h2 id="exb2_setup"><a class="docs-heading-anchor" href="#exb2_setup">Setup</a><a id="exb2_setup-1"></a><a class="docs-heading-anchor-permalink" href="#exb2_setup" title="Permalink"></a></h2><p>Now we setup the specific problem by assigning numerical values to the parameters. Odd harmonics are chosen for the Harmonic Balance since we already have some intuition on the nonlinearity (it, being an &quot;odd function&quot; nonlinearity). As before, this is followed by setting up a <code>NonlinearFunction</code> object that will be used for the continuation.</p><pre><code class="language-julia hljs">pars = (z0 = 0.5e-2, w0 = 2., kt = 5.0, fs=1.0, F = 0.1);

# h = (0:5); # Also possible
h = 1:2:5;
Om = 0.1;

Nhc = sum((h.==0)+2(h.!=0));
Nt = 2^9;

Fl = zeros(Nhc);
_,_,zinds,rinds,iinds = HINDS(1, h)
Fl[rinds[1]] = 1.0;

fun = NonlinearFunction((r,u,p)-&gt;RESFUN!([u;p],Fl,pars,h,Nt;R=r),
    jac=(J,u,p)-&gt;RESFUN!([u;p],Fl,pars,h,Nt;dRdU=J),
    paramjac=(Jp,u,p)-&gt;RESFUN!([u;p],Fl,pars,h,Nt;dRdw=Jp));</code></pre><h3 id="Check-by-solving-for-a-Single-point"><a class="docs-heading-anchor" href="#Check-by-solving-for-a-Single-point">Check by solving for a Single point</a><a id="Check-by-solving-for-a-Single-point-1"></a><a class="docs-heading-anchor-permalink" href="#Check-by-solving-for-a-Single-point" title="Permalink"></a></h3><p>We do the single point check to ensure that everything works - no errors in the residue, the Jacobian is correct, etc. This should also converge within 3-4 iterations.</p><pre><code class="language-julia hljs">E = zeros(Nhc, Nhc);
HARMONICSTIFFNESS!(E, nothing, 1.0, 2pars.z0*pars.w0, pars.w0^2+pars.kt, Om, h);
U0 = E\ (Fl*pars.F);

prob = NonlinearProblem(fun, U0, Om);
sol = solve(prob, show_trace=Val(true));</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">
Algorithm: NewtonRaphson(
    descent = NewtonDescent(),
    autodiff = AutoForwardDiff(),
    vjp_autodiff = AutoFiniteDiff(
        fdtype = Val{:forward}(),
        fdjtype = Val{:forward}(),
        fdhtype = Val{:hcentral}(),
        dir = true
    ),
    jvp_autodiff = AutoForwardDiff(),
    concrete_jac = Val{false}()
)

----    	-------------       	-----------
Iter    	f(u) inf-norm       	Step 2-norm
----    	-------------       	-----------
0       	1.84128022e-17      	0.00000000e+00
1       	1.84128022e-17      	2.22627759e-18
Final   	1.84128022e-17
----------------------</code></pre><h2 id="exb2_cont"><a class="docs-heading-anchor" href="#exb2_cont">Continuation</a><a id="exb2_cont-1"></a><a class="docs-heading-anchor-permalink" href="#exb2_cont" title="Permalink"></a></h2><p>Finally we&#39;re ready to do the continuation so we setup the system as before: initialize continuation parameters and setup the initial guess. Then we invoke <a href="../reference/#juliajim.CONTINUATION.CONTINUATE-Tuple{Vector{Float64}, Any, Vector{Float64}, Float64}"><code>CONTINUATE</code></a> to compute the solutions and then arrange the harmonics in complex notation for plotting.</p><pre><code class="language-julia hljs">Om0 = 0.02pars.w0;
Om1 = 2pars.w0;
dOm = 0.04pars.w0;
cpars = (parm=:riks, nmax=300, Dsc=:auto, minDsc=1e-2);

HARMONICSTIFFNESS!(E, nothing, 1.0, 2pars.z0*pars.w0, pars.w0^2+pars.kt, Om0, h);
U0 = E\ (Fl*pars.F);

sols, its, dss, xis, Dsc = CONTINUATE(U0, fun, [Om0, Om1], dOm; cpars...);

uh = zeros(Complex, maximum(h)+1, length(sols));
uh[h.+1, :] = hcat([[s.up[zinds]; s.up[rinds]+1im*s.up[iinds]] for s in sols]...);
Oms = [s.up[end] for s in sols];</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">
Algorithm: NewtonRaphson(
    descent = NewtonDescent(),
    autodiff = AutoForwardDiff(),
    vjp_autodiff = AutoFiniteDiff(
        fdtype = Val{:forward}(),
        fdjtype = Val{:forward}(),
        fdhtype = Val{:hcentral}(),
        dir = true
    ),
    jvp_autodiff = AutoForwardDiff(),
    concrete_jac = Val{false}()
)

----    	-------------       	-----------
Iter    	f(u) inf-norm       	Step 2-norm
----    	-------------       	-----------
0       	2.77555756e-17      	0.00000000e+00
1       	2.62851264e-17      	3.65628091e-18
Final   	2.62851264e-17
----------------------
2. 0.12 with step 0.0800 (2.0000) converged in 1 iterations. 0.000000 Δα.
3. 0.33 with step 0.2078 (3.0000) converged in 1 iterations. 0.000000 Δα.
4. 0.95 with step 0.6235 (4.5000) converged in 1 iterations. 0.000000 Δα.
5. 2.74 with step 1.8662 (6.7500) converged in 4 iterations. 0.102112 Δα.
6. 2.88 with step 0.3878 (4.8075) converged in 4 iterations. 0.091559 Δα.
7. -2.00 with step 0.0763 (3.5486) converged in 30 iterations. 0.384006 Δα.
8. -2.00 with step 0.0000 (1.7743) converged in 1 iterations. 0.002719 Δα.
9. -2.00 with step 0.0000 (2.6615) converged in 1 iterations. 0.718270 Δα.
10. -2.00 with step -0.0000 (1.9961) converged in 1 iterations. 0.002659 Δα.
11. -2.00 with step -0.0000 (2.9942) converged in 1 iterations. 0.093288 Δα.
12. -2.00 with step -0.0000 (2.9450) converged in 1 iterations. 0.014682 Δα.
13. -2.00 with step -0.0000 (4.4176) converged in 2 iterations. 0.035681 Δα.
14. -2.00 with step -0.0000 (5.0161) converged in 1 iterations. 0.011844 Δα.
15. -2.00 with step 0.0001 (7.5242) converged in 2 iterations. 0.029554 Δα.
16. -2.00 with step 0.0002 (9.1249) converged in 2 iterations. 0.028491 Δα.
17. -2.00 with step 0.0004 (10.0000) converged in 5 iterations. 0.060950 Δα.
18. -2.00 with step -0.0023 (8.4829) converged in 400 iterations. 0.058860 Δα.
19. -2.00 with step -0.0080 (7.2852) converged in 400 iterations. 0.019920 Δα.
20. -2.00 with step 0.0165 (9.1065) converged in 400 iterations. 0.021771 Δα.
21. -2.00 with step -0.0137 (10.0000) converged in 400 iterations. 0.000540 Δα.
22. -2.00 with step -0.0173 (10.0000) converged in 400 iterations. 0.065520 Δα.
23. -2.00 with step 0.0145 (8.2704) converged in 400 iterations. 0.180811 Δα.
24. -2.00 with step -0.0159 (4.9404) converged in 400 iterations. 0.080433 Δα.
25. -2.00 with step -0.0089 (3.8081) converged in 400 iterations. 0.615776 Δα.
26. -2.00 with step 0.0086 (1.9041) converged in 400 iterations. 1.183185 Δα.
27. -2.00 with step -0.0039 (0.9520) converged in 400 iterations. 2.419702 Δα.
28. -2.00 with step 0.0027 (0.4760) converged in 400 iterations. 4.684996 Δα.
29. -2.00 with step 0.0029 (0.4000) converged in 4 iterations. 5.434215 Δα.
30. -2.00 with step 0.0004 (0.4000) converged in 400 iterations. 2.303262 Δα.
31. -2.00 with step 0.0003 (0.4000) converged in 3 iterations. 1.017229 Δα.
32. -2.00 with step 0.0002 (0.4000) converged in 2 iterations. 1.125828 Δα.
33. -2.00 with step 0.0002 (0.4000) converged in 2 iterations. 0.494159 Δα.
34. -2.00 with step 0.0002 (0.4000) converged in 2 iterations. 0.236520 Δα.
35. -2.00 with step 0.0002 (0.4000) converged in 2 iterations. 0.345368 Δα.
36. -2.00 with step 0.0002 (0.4000) converged in 2 iterations. 0.858770 Δα.
37. -2.00 with step -0.0001 (0.4000) converged in 2 iterations. 0.253551 Δα.
38. -2.00 with step -0.0001 (0.4000) converged in 2 iterations. 0.282764 Δα.
39. -2.00 with step 0.0001 (0.4000) converged in 2 iterations. 0.318248 Δα.
40. -2.00 with step -0.0000 (0.4000) converged in 1 iterations. 0.178900 Δα.
41. -2.00 with step 0.0000 (0.4000) converged in 1 iterations. 0.336189 Δα.
42. -2.00 with step -0.0000 (0.4000) converged in 1 iterations. 0.116132 Δα.
43. -2.00 with step 0.0000 (0.4000) converged in 2 iterations. 1.571260 Δα.
44. -2.00 with step -0.0000 (0.4000) converged in 1 iterations. 0.426229 Δα.
45. -2.00 with step 0.0000 (0.4000) converged in 2 iterations. 0.956778 Δα.
46. -2.00 with step 0.0000 (0.4000) converged in 2 iterations. 0.621176 Δα.
47. -2.00 with step 0.0001 (0.4000) converged in 2 iterations. 0.472747 Δα.
48. -2.00 with step 0.0001 (0.4000) converged in 2 iterations. 0.453603 Δα.
49. -2.00 with step -0.0001 (0.4000) converged in 2 iterations. 0.220658 Δα.
50. -2.00 with step -0.0001 (0.4000) converged in 2 iterations. 0.193202 Δα.
51. -2.00 with step 0.0002 (0.4000) converged in 2 iterations. 0.371752 Δα.
52. -2.00 with step -0.0002 (0.4000) converged in 2 iterations. 0.465464 Δα.
53. -2.00 with step -0.0002 (0.4000) converged in 2 iterations. 0.317944 Δα.
54. -2.00 with step -0.0001 (0.4000) converged in 1 iterations. 0.344898 Δα.
55. -2.00 with step -0.0001 (0.4000) converged in 1 iterations. 0.583047 Δα.
56. -2.00 with step -0.0000 (0.4000) converged in 1 iterations. 0.979826 Δα.
57. -2.00 with step -0.0000 (0.4000) converged in 1 iterations. 0.963519 Δα.
58. -2.00 with step -0.0000 (0.4000) converged in 1 iterations. 0.266762 Δα.
59. -2.00 with step -0.0000 (0.4000) converged in 1 iterations. 0.105725 Δα.
60. -2.00 with step -0.0000 (0.4000) converged in 1 iterations. 0.205097 Δα.
61. -2.00 with step -0.0000 (0.4000) converged in 1 iterations. 0.186849 Δα.
62. -2.00 with step -0.0000 (0.4000) converged in 1 iterations. 0.141588 Δα.
63. -2.00 with step -0.0000 (0.4000) converged in 1 iterations. 0.177599 Δα.
64. -2.00 with step -0.0001 (0.4000) converged in 1 iterations. 0.219011 Δα.
65. -2.00 with step -0.0001 (0.4000) converged in 1 iterations. 0.246529 Δα.
66. -2.00 with step -0.0001 (0.4000) converged in 2 iterations. 0.230992 Δα.
67. -2.00 with step -0.0001 (0.4000) converged in 2 iterations. 0.195931 Δα.
68. -2.00 with step -0.0002 (0.4000) converged in 2 iterations. 0.310755 Δα.
69. -2.00 with step -0.0002 (0.4000) converged in 2 iterations. 0.440617 Δα.
70. -2.00 with step 0.0001 (0.4000) converged in 2 iterations. 0.485289 Δα.
71. -2.00 with step -0.0001 (0.4000) converged in 2 iterations. 1.039632 Δα.
72. -2.00 with step 0.0000 (0.4000) converged in 2 iterations. 1.563092 Δα.
73. -2.00 with step 0.0000 (0.4000) converged in 2 iterations. 0.393610 Δα.
74. -2.00 with step -0.0000 (0.4000) converged in 1 iterations. 0.113894 Δα.
75. -2.00 with step 0.0000 (0.4000) converged in 2 iterations. 0.273947 Δα.
76. -2.00 with step 0.0000 (0.4000) converged in 2 iterations. 0.227468 Δα.
77. -2.00 with step -0.0000 (0.4000) converged in 1 iterations. 0.090488 Δα.
78. -2.00 with step 0.0000 (0.4000) converged in 2 iterations. 0.247725 Δα.
79. -2.00 with step 0.0000 (0.4000) converged in 2 iterations. 0.234350 Δα.
80. -2.00 with step 0.0001 (0.4000) converged in 2 iterations. 0.263557 Δα.
81. -2.00 with step -0.0001 (0.4000) converged in 2 iterations. 0.137347 Δα.
82. -2.00 with step -0.0001 (0.4000) converged in 2 iterations. 0.260725 Δα.
83. -2.00 with step 0.0001 (0.4000) converged in 2 iterations. 0.240559 Δα.
84. -2.00 with step 0.0002 (0.4000) converged in 2 iterations. 0.509593 Δα.
85. -2.00 with step 0.0002 (0.4000) converged in 2 iterations. 0.319138 Δα.
86. -2.00 with step 0.0001 (0.4000) converged in 2 iterations. 0.393030 Δα.
87. -2.00 with step 0.0001 (0.4000) converged in 2 iterations. 0.573988 Δα.
88. -2.00 with step 0.0001 (0.4000) converged in 2 iterations. 1.535460 Δα.
89. -2.00 with step 0.0000 (0.4000) converged in 1 iterations. 0.245587 Δα.
90. -2.00 with step 0.0000 (0.4000) converged in 1 iterations. 0.395084 Δα.
91. -2.00 with step 0.0000 (0.4000) converged in 1 iterations. 0.112044 Δα.
92. -2.00 with step 0.0000 (0.4000) converged in 1 iterations. 0.272001 Δα.
93. -2.00 with step 0.0000 (0.4000) converged in 1 iterations. 0.260274 Δα.
94. -2.00 with step 0.0000 (0.4000) converged in 1 iterations. 0.182000 Δα.
95. -2.00 with step 0.0001 (0.4000) converged in 2 iterations. 0.474527 Δα.
96. -2.00 with step 0.0001 (0.4000) converged in 1 iterations. 0.205667 Δα.
97. -2.00 with step 0.0001 (0.4000) converged in 2 iterations. 0.252295 Δα.
98. -2.00 with step 0.0001 (0.4000) converged in 2 iterations. 0.164713 Δα.
99. -2.00 with step 0.0001 (0.4000) converged in 2 iterations. 0.191703 Δα.
100. -2.00 with step 0.0002 (0.4000) converged in 2 iterations. 0.318481 Δα.
101. -2.00 with step 0.0002 (0.4000) converged in 2 iterations. 0.763837 Δα.
102. -2.00 with step 0.0002 (0.4000) converged in 2 iterations. 0.300086 Δα.
103. -2.00 with step 0.0001 (0.4000) converged in 2 iterations. 0.336938 Δα.
104. -2.00 with step 0.0001 (0.4000) converged in 2 iterations. 0.307118 Δα.
105. -2.00 with step 0.0000 (0.4000) converged in 2 iterations. 0.296756 Δα.
106. -2.00 with step -0.0000 (0.4000) converged in 1 iterations. 0.084827 Δα.
107. -2.00 with step 0.0000 (0.4029) converged in 1 iterations. 0.364946 Δα.
108. -2.00 with step 0.0000 (0.4000) converged in 2 iterations. 1.153707 Δα.
109. -2.00 with step 0.0000 (0.4000) converged in 2 iterations. 3.648422 Δα.
110. -2.00 with step 0.0000 (0.4000) converged in 2 iterations. 1.186494 Δα.
111. -2.00 with step -0.0000 (0.4000) converged in 2 iterations. 0.207858 Δα.
112. -2.00 with step 0.0000 (0.4000) converged in 2 iterations. 0.512652 Δα.
113. -2.00 with step -0.0000 (0.4000) converged in 2 iterations. 0.187852 Δα.
114. -2.00 with step -0.0001 (0.4000) converged in 2 iterations. 0.198527 Δα.
115. -2.00 with step -0.0001 (0.4000) converged in 2 iterations. 0.238846 Δα.
116. -2.00 with step 0.0001 (0.4000) converged in 2 iterations. 0.320704 Δα.
117. -2.00 with step -0.0001 (0.4000) converged in 2 iterations. 0.314572 Δα.
118. -2.00 with step -0.0002 (0.4000) converged in 2 iterations. 0.379078 Δα.
119. -2.00 with step -0.0001 (0.4000) converged in 2 iterations. 0.321695 Δα.
120. -2.00 with step -0.0001 (0.4000) converged in 2 iterations. 0.465447 Δα.
121. -2.00 with step -0.0000 (0.4000) converged in 1 iterations. 0.638655 Δα.
122. -2.00 with step -0.0000 (0.4000) converged in 1 iterations. 5.014471 Δα.
123. -2.00 with step -0.0000 (0.4000) converged in 1 iterations. 0.568696 Δα.
124. -2.00 with step -0.0000 (0.4000) converged in 1 iterations. 0.182509 Δα.
125. -2.00 with step -0.0000 (0.4000) converged in 1 iterations. 0.284547 Δα.
126. -2.00 with step -0.0000 (0.4000) converged in 1 iterations. 0.209178 Δα.
127. -2.00 with step -0.0001 (0.4000) converged in 1 iterations. 0.024137 Δα.
128. -2.00 with step -0.0001 (0.5803) converged in 1 iterations. 0.209806 Δα.
129. -2.00 with step -0.0001 (0.4773) converged in 1 iterations. 0.197847 Δα.
130. -2.00 with step -0.0001 (0.4000) converged in 1 iterations. 0.279867 Δα.
131. -2.00 with step -0.0001 (0.4000) converged in 2 iterations. 0.209501 Δα.
132. -2.00 with step -0.0001 (0.4000) converged in 2 iterations. 0.208689 Δα.
133. -2.00 with step -0.0002 (0.4000) converged in 2 iterations. 0.309438 Δα.
134. -2.00 with step -0.0002 (0.4000) converged in 2 iterations. 0.464705 Δα.
135. -2.00 with step -0.0002 (0.4000) converged in 2 iterations. 0.437882 Δα.
136. -2.00 with step 0.0001 (0.4000) converged in 2 iterations. 1.245660 Δα.
137. -2.00 with step -0.0001 (0.4000) converged in 2 iterations. 0.439563 Δα.
138. -2.00 with step 0.0000 (0.4000) converged in 2 iterations. 0.417863 Δα.
139. -2.00 with step -0.0000 (0.4000) converged in 1 iterations. 0.114845 Δα.
140. -2.00 with step -0.0000 (0.4000) converged in 1 iterations. 0.095097 Δα.
141. -2.00 with step 0.0000 (0.4000) converged in 2 iterations. 0.236371 Δα.
142. -2.00 with step -0.0000 (0.4000) converged in 1 iterations. 0.092736 Δα.
143. -2.00 with step -0.0000 (0.4000) converged in 2 iterations. 0.080439 Δα.
144. -2.00 with step 0.0000 (0.4000) converged in 2 iterations. 0.239616 Δα.
145. -2.00 with step 0.0001 (0.4000) converged in 2 iterations. 0.272820 Δα.
146. -2.00 with step 0.0001 (0.4000) converged in 2 iterations. 0.331873 Δα.
147. -2.00 with step 0.0001 (0.4000) converged in 2 iterations. 0.174397 Δα.
148. -2.00 with step 0.0001 (0.4000) converged in 2 iterations. 0.250505 Δα.
149. -2.00 with step 0.0002 (0.4000) converged in 2 iterations. 0.492809 Δα.
150. -2.00 with step 0.0002 (0.4000) converged in 2 iterations. 0.330545 Δα.
151. -2.00 with step 0.0001 (0.4000) converged in 2 iterations. 0.352428 Δα.
152. -2.00 with step 0.0001 (0.4000) converged in 2 iterations. 0.599757 Δα.
153. -2.00 with step 0.0000 (0.4000) converged in 1 iterations. 1.628754 Δα.
154. -2.00 with step 0.0000 (0.4000) converged in 1 iterations. 0.266423 Δα.
155. -2.00 with step 0.0000 (0.4000) converged in 1 iterations. 0.418615 Δα.
156. -2.00 with step 0.0000 (0.4000) converged in 1 iterations. 0.118333 Δα.
157. -2.00 with step 0.0001 (0.4000) converged in 2 iterations. 0.709667 Δα.
158. -2.00 with step 0.0000 (0.4000) converged in 1 iterations. 0.100732 Δα.
159. -2.00 with step 0.0000 (0.4000) converged in 1 iterations. 0.196842 Δα.
160. -2.00 with step 0.0000 (0.4000) converged in 1 iterations. 0.147994 Δα.
161. -2.00 with step 0.0001 (0.4000) converged in 1 iterations. 0.220657 Δα.
162. -2.00 with step 0.0001 (0.4000) converged in 1 iterations. 0.271284 Δα.
163. -2.00 with step 0.0001 (0.4000) converged in 2 iterations. 0.175711 Δα.
164. -2.00 with step 0.0001 (0.4000) converged in 2 iterations. 0.205206 Δα.
165. -2.00 with step 0.0002 (0.4000) converged in 2 iterations. 0.343712 Δα.
166. -2.00 with step 0.0002 (0.4000) converged in 2 iterations. 0.764450 Δα.
167. -2.00 with step -0.0001 (0.4000) converged in 2 iterations. 0.256896 Δα.
168. -2.00 with step 0.0001 (0.4000) converged in 2 iterations. 0.359817 Δα.
169. -2.00 with step 0.0001 (0.4000) converged in 2 iterations. 0.328599 Δα.
170. -2.00 with step 0.0000 (0.4000) converged in 2 iterations. 0.322566 Δα.
171. -2.00 with step -0.0000 (0.4000) converged in 1 iterations. 0.091869 Δα.
172. -2.00 with step 0.0000 (0.4000) converged in 1 iterations. 0.430654 Δα.
173. -2.00 with step -0.0000 (0.4000) converged in 1 iterations. 0.218346 Δα.
174. -2.00 with step 0.0000 (0.4000) converged in 2 iterations. 3.729002 Δα.
175. -2.00 with step 0.0000 (0.4000) converged in 2 iterations. 1.274860 Δα.
176. -2.00 with step -0.0000 (0.4000) converged in 2 iterations. 0.219697 Δα.
177. -2.00 with step 0.0000 (0.4000) converged in 2 iterations. 0.568102 Δα.
178. -2.00 with step -0.0000 (0.4000) converged in 2 iterations. 0.216967 Δα.
179. -2.00 with step -0.0001 (0.4000) converged in 2 iterations. 0.218522 Δα.
180. -2.00 with step -0.0001 (0.4000) converged in 2 iterations. 0.219788 Δα.
181. -2.00 with step -0.0001 (0.4000) converged in 2 iterations. 0.209844 Δα.
182. -2.00 with step -0.0001 (0.4000) converged in 3 iterations. 0.325486 Δα.
183. -2.00 with step -0.0002 (0.4000) converged in 2 iterations. 0.373380 Δα.
184. -2.00 with step -0.0001 (0.4000) converged in 2 iterations. 0.328917 Δα.
185. -2.00 with step -0.0001 (0.4000) converged in 2 iterations. 0.525183 Δα.
186. -2.00 with step -0.0000 (0.4000) converged in 1 iterations. 0.727075 Δα.
187. -2.00 with step -0.0000 (0.4000) converged in 1 iterations. 5.168431 Δα.
188. -2.00 with step -0.0000 (0.4000) converged in 1 iterations. 0.168149 Δα.
189. -2.00 with step -0.0000 (0.4000) converged in 1 iterations. 0.225803 Δα.
190. -2.00 with step -0.0000 (0.4000) converged in 1 iterations. 0.113850 Δα.
191. -2.00 with step -0.0000 (0.4000) converged in 1 iterations. 0.255336 Δα.
192. -2.00 with step -0.0000 (0.4000) converged in 1 iterations. 0.159439 Δα.
193. -2.00 with step -0.0000 (0.4000) converged in 1 iterations. 0.172094 Δα.
194. -2.00 with step -0.0000 (0.4000) converged in 1 iterations. 0.188170 Δα.
195. -2.00 with step -0.0001 (0.4000) converged in 1 iterations. 0.241899 Δα.
196. -2.00 with step -0.0001 (0.4000) converged in 2 iterations. 0.210115 Δα.
197. -2.00 with step -0.0001 (0.4000) converged in 2 iterations. 0.209327 Δα.
198. -2.00 with step 0.0002 (0.4000) converged in 3 iterations. 0.399132 Δα.
199. -2.00 with step -0.0002 (0.4000) converged in 2 iterations. 0.575426 Δα.
200. -2.00 with step 0.0002 (0.4000) converged in 2 iterations. 0.441721 Δα.
201. -2.00 with step -0.0001 (0.4000) converged in 2 iterations. 0.775324 Δα.
202. -2.00 with step 0.0000 (0.4000) converged in 2 iterations. 4.508339 Δα.
203. -2.00 with step 0.0000 (0.4000) converged in 2 iterations. 0.478818 Δα.
204. -2.00 with step 0.0000 (0.4000) converged in 1 iterations. 0.255452 Δα.
205. -2.00 with step -0.0000 (0.4000) converged in 1 iterations. 0.115306 Δα.
206. -2.00 with step -0.0000 (0.4000) converged in 1 iterations. 0.095624 Δα.
207. -2.00 with step -0.0000 (0.4000) converged in 1 iterations. 0.083710 Δα.
208. -2.00 with step 0.0000 (0.4042) converged in 2 iterations. 0.206375 Δα.
209. -2.00 with step -0.0001 (0.4000) converged in 2 iterations. 0.077410 Δα.
210. -2.00 with step 0.0000 (0.4000) converged in 2 iterations. 0.233202 Δα.
211. -2.00 with step -0.0001 (0.4000) converged in 2 iterations. 0.119039 Δα.
212. -2.00 with step -0.0001 (0.4000) converged in 2 iterations. 0.153977 Δα.
213. -2.00 with step -0.0002 (0.4000) converged in 2 iterations. 0.219533 Δα.
214. -2.00 with step -0.0002 (0.4000) converged in 2 iterations. 0.218297 Δα.
215. -2.00 with step 0.0002 (0.4000) converged in 2 iterations. 0.355165 Δα.
216. -2.00 with step 0.0001 (0.4000) converged in 2 iterations. 0.344007 Δα.
217. -2.00 with step 0.0001 (0.4000) converged in 2 iterations. 0.491647 Δα.
218. -2.00 with step 0.0001 (0.4000) converged in 2 iterations. 1.080979 Δα.
219. -2.00 with step 0.0000 (0.4000) converged in 1 iterations. 0.902720 Δα.
220. -2.00 with step 0.0000 (0.4000) converged in 1 iterations. 0.347489 Δα.
221. -2.00 with step 0.0000 (0.4000) converged in 1 iterations. 0.125352 Δα.
222. -2.00 with step 0.0000 (0.4000) converged in 1 iterations. 0.088529 Δα.
223. -2.00 with step 0.0000 (0.4000) converged in 1 iterations. 0.122074 Δα.
224. -2.00 with step 0.0000 (0.4000) converged in 1 iterations. 0.234270 Δα.
225. -2.00 with step 0.0000 (0.4000) converged in 1 iterations. 0.179155 Δα.
226. -2.00 with step 0.0001 (0.4000) converged in 1 iterations. 0.175810 Δα.
227. -2.00 with step 0.0001 (0.4000) converged in 2 iterations. 0.247045 Δα.
228. -2.00 with step 0.0001 (0.4000) converged in 2 iterations. 0.165186 Δα.
229. -2.00 with step 0.0001 (0.4000) converged in 2 iterations. 0.211059 Δα.
230. -2.00 with step 0.0002 (0.4000) converged in 2 iterations. 0.343008 Δα.
231. -2.00 with step -0.0002 (0.4000) converged in 2 iterations. 0.413903 Δα.
232. -2.00 with step 0.0002 (0.4000) converged in 2 iterations. 0.310863 Δα.
233. -2.00 with step 0.0001 (0.4000) converged in 2 iterations. 0.365898 Δα.
234. -2.00 with step -0.0000 (0.4000) converged in 2 iterations. 0.290280 Δα.
235. -2.00 with step -0.0000 (0.4000) converged in 1 iterations. 0.146516 Δα.
236. -2.00 with step -0.0000 (0.4000) converged in 1 iterations. 0.111455 Δα.
237. -2.00 with step 0.0000 (0.4000) converged in 1 iterations. 0.634168 Δα.
238. -2.00 with step -0.0000 (0.4000) converged in 1 iterations. 0.300813 Δα.
239. -2.00 with step -0.0000 (0.4000) converged in 1 iterations. 0.226263 Δα.
240. -2.00 with step -0.0000 (0.4000) converged in 1 iterations. 0.194742 Δα.
241. -2.00 with step -0.0000 (0.4000) converged in 2 iterations. 0.170197 Δα.
242. -2.00 with step 0.0001 (0.4000) converged in 2 iterations. 0.485995 Δα.
243. -2.00 with step -0.0001 (0.4000) converged in 2 iterations. 0.219231 Δα.
244. -2.00 with step -0.0001 (0.4000) converged in 2 iterations. 0.232640 Δα.
245. -2.00 with step 0.0001 (0.4000) converged in 2 iterations. 0.279145 Δα.
246. -2.00 with step 0.0002 (0.4000) converged in 2 iterations. 0.338538 Δα.
247. -2.00 with step -0.0002 (0.4000) converged in 2 iterations. 0.374181 Δα.
248. -2.00 with step -0.0002 (0.4000) converged in 2 iterations. 0.335705 Δα.
249. -2.00 with step -0.0001 (0.4000) converged in 2 iterations. 0.354659 Δα.
250. -2.00 with step -0.0001 (0.4000) converged in 1 iterations. 0.492941 Δα.
251. -2.00 with step -0.0000 (0.4000) converged in 1 iterations. 0.864685 Δα.
252. -2.00 with step -0.0000 (0.4000) converged in 1 iterations. 0.826356 Δα.
253. -2.00 with step -0.0000 (0.4000) converged in 1 iterations. 0.228278 Δα.
254. -2.00 with step -0.0000 (0.4000) converged in 1 iterations. 0.316375 Δα.
255. -2.00 with step -0.0000 (0.4000) converged in 1 iterations. 0.184560 Δα.
256. -2.00 with step -0.0000 (0.4000) converged in 1 iterations. 0.167360 Δα.
257. -2.00 with step -0.0000 (0.4000) converged in 1 iterations. 0.226592 Δα.
258. -2.00 with step -0.0000 (0.4000) converged in 1 iterations. 0.159587 Δα.
259. -2.00 with step -0.0001 (0.4000) converged in 1 iterations. 0.196636 Δα.
260. -2.00 with step -0.0001 (0.4000) converged in 1 iterations. 0.281194 Δα.
261. -2.00 with step -0.0001 (0.4000) converged in 2 iterations. 0.210041 Δα.
262. -2.00 with step -0.0001 (0.4000) converged in 2 iterations. 0.201461 Δα.
263. -2.00 with step -0.0002 (0.4000) converged in 2 iterations. 0.299319 Δα.
264. -2.00 with step -0.0002 (0.4000) converged in 2 iterations. 0.486847 Δα.
265. -2.00 with step -0.0002 (0.4000) converged in 2 iterations. 0.430807 Δα.
266. -2.00 with step -0.0001 (0.4000) converged in 2 iterations. 0.990758 Δα.
267. -2.00 with step -0.0001 (0.4000) converged in 2 iterations. 0.737390 Δα.
268. -2.00 with step 0.0000 (0.4000) converged in 2 iterations. 0.348169 Δα.
269. -2.00 with step -0.0000 (0.4000) converged in 1 iterations. 0.102095 Δα.
270. -2.00 with step 0.0000 (0.4000) converged in 2 iterations. 0.263657 Δα.
271. -2.00 with step 0.0000 (0.4000) converged in 2 iterations. 0.207664 Δα.
272. -2.00 with step 0.0000 (0.4000) converged in 2 iterations. 0.246535 Δα.
273. -2.00 with step 0.0000 (0.4000) converged in 2 iterations. 0.233918 Δα.
274. -2.00 with step 0.0000 (0.4000) converged in 2 iterations. 0.216379 Δα.
275. -2.00 with step -0.0001 (0.4000) converged in 2 iterations. 0.091916 Δα.
276. -2.00 with step 0.0001 (0.4000) converged in 2 iterations. 0.353823 Δα.
277. -2.00 with step 0.0001 (0.4000) converged in 2 iterations. 0.182090 Δα.
278. -2.00 with step 0.0001 (0.4000) converged in 2 iterations. 0.241395 Δα.
279. -2.00 with step 0.0002 (0.4000) converged in 2 iterations. 0.483976 Δα.
280. -2.00 with step 0.0002 (0.4000) converged in 2 iterations. 0.314892 Δα.
281. -2.00 with step 0.0001 (0.4000) converged in 2 iterations. 0.393222 Δα.
282. -2.00 with step 0.0001 (0.4000) converged in 2 iterations. 0.500536 Δα.
283. -2.00 with step 0.0000 (0.4000) converged in 1 iterations. 1.361638 Δα.
284. -2.00 with step 0.0000 (0.4000) converged in 1 iterations. 0.221887 Δα.
285. -2.00 with step 0.0000 (0.4000) converged in 1 iterations. 0.392808 Δα.
286. -2.00 with step 0.0000 (0.4000) converged in 1 iterations. 0.114948 Δα.
287. -2.00 with step 0.0000 (0.4000) converged in 1 iterations. 0.277003 Δα.
288. -2.00 with step 0.0000 (0.4000) converged in 1 iterations. 0.097737 Δα.
289. -2.00 with step 0.0000 (0.4000) converged in 1 iterations. 0.192446 Δα.
290. -2.00 with step 0.0000 (0.4000) converged in 1 iterations. 0.144656 Δα.
291. -2.00 with step 0.0001 (0.4000) converged in 1 iterations. 0.216472 Δα.
292. -2.00 with step 0.0001 (0.4000) converged in 1 iterations. 0.266015 Δα.
293. -2.00 with step 0.0001 (0.4000) converged in 2 iterations. 0.172674 Δα.
294. -2.00 with step 0.0001 (0.4000) converged in 2 iterations. 0.201476 Δα.
295. -2.00 with step 0.0002 (0.4000) converged in 2 iterations. 0.336897 Δα.
296. -2.00 with step 0.0002 (0.4000) converged in 2 iterations. 0.750169 Δα.
297. -2.00 with step -0.0001 (0.4000) converged in 2 iterations. 0.252663 Δα.
298. -2.00 with step 0.0001 (0.4000) converged in 2 iterations. 0.351362 Δα.
299. -2.00 with step 0.0001 (0.4000) converged in 2 iterations. 0.320326 Δα.
300. -2.00 with step 0.0000 (0.4000) converged in 2 iterations. 0.311731 Δα.
301. -2.00 with step -0.0000 (0.4000) converged in 1 iterations. 0.088702 Δα.</code></pre><h2 id="exb2_plot"><a class="docs-heading-anchor" href="#exb2_plot">Plotting</a><a id="exb2_plot-1"></a><a class="docs-heading-anchor-permalink" href="#exb2_plot" title="Permalink"></a></h2><p>Here again, we visualize the harmonic contents. Unlike the previous example, a very clear non-smooth behavior can be noticed here. It is only near the resonance, when amplitude is large, where the higher harmonics show up. At other frequencies, the higher harmonics are all zero.</p><pre><code class="language-julia hljs">his = [1, 3, 5];

fsz = 24;
fig = Figure(fontsize=fsz, size=(1000, 600));

ax1s = [];
ax2s = [];
for i in eachindex(his[his.&lt;=maximum(h)])
    ax = Axis(fig[1, i],
        ylabel=L&quot;$H_%$(his[i])$ Response (m)&quot;, yscale=log10);
    scatterlines!(ax, Oms, abs.(uh[his[i].+1, :]));
    push!(ax1s, ax)

    ax = Axis(fig[2, i], xlabel=L&quot;Excitation Frequency $\Omega$&quot;,
        ylabel=L&quot;$H_%$(his[i])$ Phase (rad)&quot;);
    scatterlines!(ax, Oms, unwrap(angle.(uh[his[i].+1, :])));
    push!(ax2s, ax)
end
linkxaxes!(vcat(ax1s, ax2s)...)

    fig</code></pre><img src="76f774ae.png" alt="Example block output"/><h2 id="exb2_outro"><a class="docs-heading-anchor" href="#exb2_outro">Outro</a><a id="exb2_outro-1"></a><a class="docs-heading-anchor-permalink" href="#exb2_outro" title="Permalink"></a></h2><p>This is yet another example of using the utility functions in <a href="../reference/#juliajim.HARMONIC"><code>HARMONIC</code></a> for conducting harmonic balance. Looking at <a href="../b1_duffhb/#ex_b1"><code>Example b1</code></a> and this, it must be clear that a lot of the &quot;setup&quot; that has to be done for any given system is very similar. So it makes sense to have a unified interface which constructs the different residue functions for a given system with its nonlinearity. This is precisely what the <a href="../reference/#juliajim.MDOFUTILS"><code>MDOFUTILS</code></a> module sets out to do.</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../b1_duffhb/">« 1: Duffing Oscillator</a><a class="docs-footer-nextpage" href="../c1_mdofgen_instnl/">1: Forced Response of a 2DoF Oscillator with Instantaneous Nonlinearity »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Saturday 10 January 2026 10:53">Saturday 10 January 2026</span>. Using Julia version 1.12.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
