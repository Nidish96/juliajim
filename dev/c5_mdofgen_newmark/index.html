<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>5: Transient Response of a 2DoF Hysteretic Oscillator using Newmark Scheme · juliajim</title><meta name="title" content="5: Transient Response of a 2DoF Hysteretic Oscillator using Newmark Scheme · juliajim"/><meta property="og:title" content="5: Transient Response of a 2DoF Hysteretic Oscillator using Newmark Scheme · juliajim"/><meta property="twitter:title" content="5: Transient Response of a 2DoF Hysteretic Oscillator using Newmark Scheme · juliajim"/><meta name="description" content="Documentation for juliajim."/><meta property="og:description" content="Documentation for juliajim."/><meta property="twitter:description" content="Documentation for juliajim."/><meta property="og:url" content="https://github.com/Nidish96/juliajim/c5_mdofgen_newmark/"/><meta property="twitter:url" content="https://github.com/Nidish96/juliajim/c5_mdofgen_newmark/"/><link rel="canonical" href="https://github.com/Nidish96/juliajim/c5_mdofgen_newmark/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/custom.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">juliajim</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../a_hworld/">A: Harmonic Utilities</a></li><li><input class="collapse-toggle" id="menuitem-2-2" type="checkbox"/><label class="tocitem" for="menuitem-2-2"><span class="docs-label">B: Numerical Continuation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../b1_duffhb/">1: Duffing Oscillator</a></li><li><a class="tocitem" href="../b2_jenkhb/">2: Frictional Oscillator</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-3" type="checkbox" checked/><label class="tocitem" for="menuitem-2-3"><span class="docs-label">C: Examples with the MDOFUTILS Suite</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../c1_mdofgen_instnl/">1: Forced Response of a 2DoF Oscillator with Instantaneous Nonlinearity</a></li><li><a class="tocitem" href="../c2_mdofgen_hystnl/">2: Forced Response of a 2DoF Oscillator with Hysteretic Nonlinearity</a></li><li><a class="tocitem" href="../c3_mdofgen_ahb/">3: Response Constrained Forced Response of a 2DoF Hysteretic Oscillator</a></li><li><a class="tocitem" href="../c4_mdofgen_epmc/">4: Nonlinear Normal Modes of a 2DoF Hysteretic Oscillator using EPMC</a></li><li class="is-active"><a class="tocitem" href>5: Transient Response of a 2DoF Hysteretic Oscillator using Newmark Scheme</a><ul class="internal"><li><a class="tocitem" href="#Preamble:-Load-Packages"><span>Preamble: Load Packages</span></a></li><li><a class="tocitem" href="#exc5_setup"><span>System Setup</span></a></li><li><a class="tocitem" href="#exc5_trans"><span>Transient March</span></a></li><li><a class="tocitem" href="#exc5_plot"><span>Plotting</span></a></li></ul></li></ul></li></ul></li><li><a class="tocitem" href="../reference/">Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li><a class="is-disabled">C: Examples with the MDOFUTILS Suite</a></li><li class="is-active"><a href>5: Transient Response of a 2DoF Hysteretic Oscillator using Newmark Scheme</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>5: Transient Response of a 2DoF Hysteretic Oscillator using Newmark Scheme</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/Nidish96/juliajim/blob/master/examples/c5_mdofgen_newmark.jl#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="ex_c5"><a class="docs-heading-anchor" href="#ex_c5">Example C5: Transient Response of a 2DoF Hysteretic Oscillator using A Newmark Scheme</a><a id="ex_c5-1"></a><a class="docs-heading-anchor-permalink" href="#ex_c5" title="Permalink"></a></h1><p>In this example we show how the <a href="../reference/#juliajim.MDOFUTILS"><code>MDOFUTILS</code></a> suite can also be used for conducting transient analysis. A natural question may be why not just use SciML&#39;s <a href="https://docs.sciml.ai/DiffEqDocs/stable/">DifferentialEquations.jl</a>. The answer lies in hysteretic nonlinearities implemented in the incremental formalism. It is not trivial to use existing methods for integrating these systems without additional complexity (computational as well as conceptual).</p><p>However, classical second order methods (central difference, linear acceleration, Newmark-(\beta), Wilson-(\theta), HHT-(\alpha), etc.) <strong>naturally lend themselves to hysterestic systems</strong>! This is because these integrators require the difference in force between the previous and the next time instants, which is the most convenient way of specifying an incremental hysteretic nonlinearity.</p><p>Here we analyze the same 2DoF oscillator as in the last few examples:</p><p class="math-container">\[\underbrace{\begin{bmatrix} 1&amp;0\\0&amp;1 \end{bmatrix}}_{\mx{M}} \begin{bmatrix} \ddot{x_1}\\ \ddot{x_2} \end{bmatrix} +
\left( 0.01 \mx{M} + 0.001 \mx{K}\right) \begin{bmatrix} \dot{x_1}\\ \dot{x_2} \end{bmatrix} + \underbrace{\begin{bmatrix} 2&amp;-1\\-1&amp;2 \end{bmatrix}}_{\mx{K}} \begin{bmatrix} x_1\\x_2 \end{bmatrix} + \begin{bmatrix} 0\\ f_{fr}(x_2) \end{bmatrix} = \begin{bmatrix} 1\\0 \end{bmatrix}\cos\Omega t.\]</p><p>The steps followed in the example are:</p><ol><li><a href="#exc5_setup">First</a> we setup the system and the nonlinearity (and also check the nonlinear force evaluation).</li><li><a href="#exc5_trans">Then</a> we setup the initial conditions and transient analysis parameters and do the actual analysis.</li><li><a href="#exc5_trans">Finally</a> we visualize the results.</li></ol><h2 id="Preamble:-Load-Packages"><a class="docs-heading-anchor" href="#Preamble:-Load-Packages">Preamble: Load Packages</a><a id="Preamble:-Load-Packages-1"></a><a class="docs-heading-anchor-permalink" href="#Preamble:-Load-Packages" title="Permalink"></a></h2><pre><code class="language-julia hljs">using GLMakie
using LinearAlgebra
using SparseArrays
using ForwardDiff
using NonlinearSolve
using DSP

using juliajim.HARMONIC
using juliajim.CONTINUATION
using juliajim.MDOFUTILS</code></pre><h2 id="exc5_setup"><a class="docs-heading-anchor" href="#exc5_setup">System Setup</a><a id="exc5_setup-1"></a><a class="docs-heading-anchor-permalink" href="#exc5_setup" title="Permalink"></a></h2><pre><code class="language-julia hljs">M = I(2);
K = [2 -1;-1 2];
C = 0.01*M+0.001*K;

mdl = MDOFGEN(M, C, K);

# Nonlinearity
kt = 1.0;
fs = 1.0;
fnl = (t,u,up,fp)-&gt; if all(abs.(fp+kt*(u-up)).&lt;fs)
    return fp+kt*(u-up), kt*ones(size(u)), -kt*ones(size(u)), ones(size(u)); else
        return fs*sign.(fp+kt*(u-up)), zeros(size(u)), zeros(size(u)), zeros(size(u));
end
L = [0.0 1.0];
Fv = [1.0, 0.0];

mdl = ADDNL(mdl, :Hyst, fnl, L);</code></pre><h3 id="Nonlinear-Force-Evaluation"><a class="docs-heading-anchor" href="#Nonlinear-Force-Evaluation">Nonlinear Force Evaluation</a><a id="Nonlinear-Force-Evaluation-1"></a><a class="docs-heading-anchor-permalink" href="#Nonlinear-Force-Evaluation" title="Permalink"></a></h3><p>Here we test the nonlinear force evaluation using the <a href="../reference/#juliajim.MDOFUTILS.NLFORCE-Tuple{MDOFGEN, Any, Any, Any}"><code>NLFORCE</code></a> routine, which is used internally to compute the nonlinear forces in time domain. This function requires, at minimum, the time and displacement-velocity states. But it also accepts the states at the previous instant for the computation (very much relevant for hysteretic nonlinearities). If these are not provided, they are all defaulted to zero. Apart from the nonlinear force and its Jacobians, the routine also outputs <code>S</code>, which is a Vector as long as the number of nonlinearities present. Each element of the vector is a vector of the forces of the nonlinearity. These are relevant for hysteretic nonlinearities where explicit history dependence is very important.</p><pre><code class="language-julia hljs">Fnl, dFnldU, dFnldUd, S = NLFORCE(mdl, 0, zeros(2), zeros(2))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([0.0, 0.0], [0.0 0.0; 0.0 1.0], [0.0 0.0; 0.0 0.0], [[0.0]])</code></pre><h2 id="exc5_trans"><a class="docs-heading-anchor" href="#exc5_trans">Transient March</a><a id="exc5_trans-1"></a><a class="docs-heading-anchor-permalink" href="#exc5_trans" title="Permalink"></a></h2><p>Now we are ready to conduct the transient simulation. We set trivial initial conditions and provide periodic excitation at a point well below the first resonance (which is at (1) rad/s).</p><pre><code class="language-julia hljs">U0 = zeros(2);
Ud0 = zeros(2);
fsamp = 10;
Om = 0.6;  # rad/s
Famp = 4;
Fex = t-&gt; Famp*Fv*cos(Om*t);
Tmax = 2π/Om*100;

t = 0:1/fsamp:Tmax;

U, Ud, Udd, S = NEWMARKMARCH(mdl, 0, Tmax, 1/fsamp, U0, Ud0, Fex, verbosity=100)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([0.0 0.019870856773473142 … 2.936038297187127 2.900074340210415; 0.0 5.0263550017217084e-5 … 1.8097526169072649 1.9695642563593108], [0.0 0.3974171354694628 … -0.36173965145484505 -0.3575394880793878; 0.0 0.0010052710003443416 … 1.6921562740640492 1.5040765149768676], [4.0 3.9483427093892547 … -0.08435712475735091 0.1683603922664969; 0.0 0.02010542000688682 … -1.7041345515676263 -2.057460630176008], [[0.0] [5.0263550017217084e-5] … [1.0] [1.0]], [-0.030495484293258556 -0.025212264967118914 -0.06049990969882613 -0.04403017777302315; 0.06372289549893381 -0.03552623315425922 -0.010635606053282917 0.06039997860303378; -0.03696884575033172 -0.052687796121016484 -0.1885411632957658 -0.09422027590588543; 0.1141896874864862 -0.15038343607781926 0.06437856361968142 0.02276893492976485])</code></pre><h2 id="exc5_plot"><a class="docs-heading-anchor" href="#exc5_plot">Plotting</a><a id="exc5_plot-1"></a><a class="docs-heading-anchor-permalink" href="#exc5_plot" title="Permalink"></a></h2><p>Now we plot all the results. We plot them in terms of the states (displacements and velocities from <code>U</code>, <code>Ud</code>) as well as the slider internal forces from <code>S</code>. A strongly nonlinear response can be observed with the steady-state zoom-in (to the last cycle) showing highly non-smooth behavior. The displacement and velocity plots also show a significant presence of higher harmonics, underlying the same.</p><pre><code class="language-julia hljs">set_theme!(theme_latexfonts())
fsz = 20;
fig = Figure(fontsize=fsz, size=(1000, 600));

ax1 = Axis(fig[1, 1:2], ylabel=&quot;Displacement (m)&quot;, title=&quot;Complete Response&quot;);
for i in 1:2
    lines!(ax1, t, U[i,:])
end
ax10 = Axis(fig[1, 3], title=&quot;Steady State&quot;);
for i in 1:2
    scatterlines!(ax10, t, U[i,:], label=&quot;x$(i)&quot;)
end
axislegend(ax10, position=:ct)
xlims!(ax10, Tmax-2π/Om, Tmax);
ylims!(ax10, -maximum(abs.(U)), maximum(abs.(U)));

ax2 = Axis(fig[2, 1:2], ylabel=&quot;Velocity (m/s)&quot;);
for i in 1:2
    lines!(ax2, t, Ud[i,:])
end
ax20 = Axis(fig[2, 3]);
for i in 1:2
    scatterlines!(ax20, t, Ud[i,:])
end
xlims!(ax20, Tmax-2π/Om, Tmax);
ylims!(ax20, -maximum(abs.(Ud)), maximum(abs.(Ud)));

ax3 = Axis(fig[3, 1:2], xlabel=&quot;Time (s)&quot;, ylabel=&quot;Friction force (N)&quot;)
lines!(ax3, t, getindex.(S, 1)[:])
ax30 = Axis(fig[3, 3], xlabel=&quot;Time (s)&quot;)
scatterlines!(ax30, t, getindex.(S, 1)[:])
xlims!(ax30, Tmax-2π/Om, Tmax);

linkxaxes!(ax1, ax2, ax3);

   fig</code></pre><img src="db707179.png" alt="Example block output"/><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../c4_mdofgen_epmc/">« 4: Nonlinear Normal Modes of a 2DoF Hysteretic Oscillator using EPMC</a><a class="docs-footer-nextpage" href="../reference/">Reference »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Thursday 21 August 2025 08:47">Thursday 21 August 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
